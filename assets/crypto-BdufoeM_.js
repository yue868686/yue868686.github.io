import{g as ds,c as hr}from"./antd-D61CRulc.js";var J0={exports:{}};function ls(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var et={exports:{}};const ps={},gs=Object.freeze(Object.defineProperty({__proto__:null,default:ps},Symbol.toStringTag,{value:"Module"})),ws=ds(gs);var Es=et.exports,En;function V(){return En||(En=1,(function(e,t){(function(n,r){e.exports=r()})(Es,function(){var n=n||(function(r,o){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof hr<"u"&&hr.crypto&&(i=hr.crypto),!i&&typeof ls=="function")try{i=ws}catch{}var s=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||(function(){function w(){}return function(g){var v;return w.prototype=g,v=new w,w.prototype=null,v}})(),f={},c=f.lib={},x=c.Base=(function(){return{extend:function(w){var g=a(this);return w&&g.mixIn(w),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var g in w)w.hasOwnProperty(g)&&(this[g]=w[g]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),h=c.WordArray=x.extend({init:function(w,g){w=this.words=w||[],g!=o?this.sigBytes=g:this.sigBytes=w.length*4},toString:function(w){return(w||d).stringify(this)},concat:function(w){var g=this.words,v=w.words,b=this.sigBytes,C=w.sigBytes;if(this.clamp(),b%4)for(var F=0;F<C;F++){var _=v[F>>>2]>>>24-F%4*8&255;g[b+F>>>2]|=_<<24-(b+F)%4*8}else for(var I=0;I<C;I+=4)g[b+I>>>2]=v[I>>>2];return this.sigBytes+=C,this},clamp:function(){var w=this.words,g=this.sigBytes;w[g>>>2]&=4294967295<<32-g%4*8,w.length=r.ceil(g/4)},clone:function(){var w=x.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var g=[],v=0;v<w;v+=4)g.push(s());return new h.init(g,w)}}),u=f.enc={},d=u.Hex={stringify:function(w){for(var g=w.words,v=w.sigBytes,b=[],C=0;C<v;C++){var F=g[C>>>2]>>>24-C%4*8&255;b.push((F>>>4).toString(16)),b.push((F&15).toString(16))}return b.join("")},parse:function(w){for(var g=w.length,v=[],b=0;b<g;b+=2)v[b>>>3]|=parseInt(w.substr(b,2),16)<<24-b%8*4;return new h.init(v,g/2)}},l=u.Latin1={stringify:function(w){for(var g=w.words,v=w.sigBytes,b=[],C=0;C<v;C++){var F=g[C>>>2]>>>24-C%4*8&255;b.push(String.fromCharCode(F))}return b.join("")},parse:function(w){for(var g=w.length,v=[],b=0;b<g;b++)v[b>>>2]|=(w.charCodeAt(b)&255)<<24-b%4*8;return new h.init(v,g)}},E=u.Utf8={stringify:function(w){try{return decodeURIComponent(escape(l.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return l.parse(unescape(encodeURIComponent(w)))}},p=c.BufferedBlockAlgorithm=x.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=E.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var g,v=this._data,b=v.words,C=v.sigBytes,F=this.blockSize,_=F*4,I=C/_;w?I=r.ceil(I):I=r.max((I|0)-this._minBufferSize,0);var A=I*F,D=r.min(A*4,C);if(A){for(var H=0;H<A;H+=F)this._doProcessBlock(b,H);g=b.splice(0,A),v.sigBytes-=D}return new h.init(g,D)},clone:function(){var w=x.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});c.Hasher=p.extend({cfg:x.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var g=this._doFinalize();return g},blockSize:16,_createHelper:function(w){return function(g,v){return new w.init(v).finalize(g)}},_createHmacHelper:function(w){return function(g,v){return new y.HMAC.init(w,v).finalize(g)}}});var y=f.algo={};return f})(Math);return n})})(et)),et.exports}var tt={exports:{}},vs=tt.exports,vn;function Jt(){return vn||(vn=1,(function(e,t){(function(n,r){e.exports=r(V())})(vs,function(n){return(function(r){var o=n,i=o.lib,s=i.Base,a=i.WordArray,f=o.x64={};f.Word=s.extend({init:function(c,x){this.high=c,this.low=x}}),f.WordArray=s.extend({init:function(c,x){c=this.words=c||[],x!=r?this.sigBytes=x:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,x=c.length,h=[],u=0;u<x;u++){var d=c[u];h.push(d.high),h.push(d.low)}return a.create(h,this.sigBytes)},clone:function(){for(var c=s.clone.call(this),x=c.words=this.words.slice(0),h=x.length,u=0;u<h;u++)x[u]=x[u].clone();return c}})})(),n})})(tt)),tt.exports}var rt={exports:{}},ys=rt.exports,yn;function bs(){return yn||(yn=1,(function(e,t){(function(n,r){e.exports=r(V())})(ys,function(n){return(function(){if(typeof ArrayBuffer=="function"){var r=n,o=r.lib,i=o.WordArray,s=i.init,a=i.init=function(f){if(f instanceof ArrayBuffer&&(f=new Uint8Array(f)),(f instanceof Int8Array||typeof Uint8ClampedArray<"u"&&f instanceof Uint8ClampedArray||f instanceof Int16Array||f instanceof Uint16Array||f instanceof Int32Array||f instanceof Uint32Array||f instanceof Float32Array||f instanceof Float64Array)&&(f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength)),f instanceof Uint8Array){for(var c=f.byteLength,x=[],h=0;h<c;h++)x[h>>>2]|=f[h]<<24-h%4*8;s.call(this,x,c)}else s.apply(this,arguments)};a.prototype=i}})(),n.lib.WordArray})})(rt)),rt.exports}var nt={exports:{}},Bs=nt.exports,bn;function As(){return bn||(bn=1,(function(e,t){(function(n,r){e.exports=r(V())})(Bs,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=r.enc;s.Utf16=s.Utf16BE={stringify:function(f){for(var c=f.words,x=f.sigBytes,h=[],u=0;u<x;u+=2){var d=c[u>>>2]>>>16-u%4*8&65535;h.push(String.fromCharCode(d))}return h.join("")},parse:function(f){for(var c=f.length,x=[],h=0;h<c;h++)x[h>>>1]|=f.charCodeAt(h)<<16-h%2*16;return i.create(x,c*2)}},s.Utf16LE={stringify:function(f){for(var c=f.words,x=f.sigBytes,h=[],u=0;u<x;u+=2){var d=a(c[u>>>2]>>>16-u%4*8&65535);h.push(String.fromCharCode(d))}return h.join("")},parse:function(f){for(var c=f.length,x=[],h=0;h<c;h++)x[h>>>1]|=a(f.charCodeAt(h)<<16-h%2*16);return i.create(x,c*2)}};function a(f){return f<<8&4278255360|f>>>8&16711935}})(),n.enc.Utf16})})(nt)),nt.exports}var ot={exports:{}},Cs=ot.exports,Bn;function r0(){return Bn||(Bn=1,(function(e,t){(function(n,r){e.exports=r(V())})(Cs,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=r.enc;s.Base64={stringify:function(f){var c=f.words,x=f.sigBytes,h=this._map;f.clamp();for(var u=[],d=0;d<x;d+=3)for(var l=c[d>>>2]>>>24-d%4*8&255,E=c[d+1>>>2]>>>24-(d+1)%4*8&255,p=c[d+2>>>2]>>>24-(d+2)%4*8&255,y=l<<16|E<<8|p,w=0;w<4&&d+w*.75<x;w++)u.push(h.charAt(y>>>6*(3-w)&63));var g=h.charAt(64);if(g)for(;u.length%4;)u.push(g);return u.join("")},parse:function(f){var c=f.length,x=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var u=0;u<x.length;u++)h[x.charCodeAt(u)]=u}var d=x.charAt(64);if(d){var l=f.indexOf(d);l!==-1&&(c=l)}return a(f,c,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(f,c,x){for(var h=[],u=0,d=0;d<c;d++)if(d%4){var l=x[f.charCodeAt(d-1)]<<d%4*2,E=x[f.charCodeAt(d)]>>>6-d%4*2,p=l|E;h[u>>>2]|=p<<24-u%4*8,u++}return i.create(h,u)}})(),n.enc.Base64})})(ot)),ot.exports}var it={exports:{}},ms=it.exports,An;function Ds(){return An||(An=1,(function(e,t){(function(n,r){e.exports=r(V())})(ms,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=r.enc;s.Base64url={stringify:function(f,c){c===void 0&&(c=!0);var x=f.words,h=f.sigBytes,u=c?this._safe_map:this._map;f.clamp();for(var d=[],l=0;l<h;l+=3)for(var E=x[l>>>2]>>>24-l%4*8&255,p=x[l+1>>>2]>>>24-(l+1)%4*8&255,y=x[l+2>>>2]>>>24-(l+2)%4*8&255,w=E<<16|p<<8|y,g=0;g<4&&l+g*.75<h;g++)d.push(u.charAt(w>>>6*(3-g)&63));var v=u.charAt(64);if(v)for(;d.length%4;)d.push(v);return d.join("")},parse:function(f,c){c===void 0&&(c=!0);var x=f.length,h=c?this._safe_map:this._map,u=this._reverseMap;if(!u){u=this._reverseMap=[];for(var d=0;d<h.length;d++)u[h.charCodeAt(d)]=d}var l=h.charAt(64);if(l){var E=f.indexOf(l);E!==-1&&(x=E)}return a(f,x,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(f,c,x){for(var h=[],u=0,d=0;d<c;d++)if(d%4){var l=x[f.charCodeAt(d-1)]<<d%4*2,E=x[f.charCodeAt(d)]>>>6-d%4*2,p=l|E;h[u>>>2]|=p<<24-u%4*8,u++}return i.create(h,u)}})(),n.enc.Base64url})})(it)),it.exports}var st={exports:{}},Fs=st.exports,Cn;function n0(){return Cn||(Cn=1,(function(e,t){(function(n,r){e.exports=r(V())})(Fs,function(n){return(function(r){var o=n,i=o.lib,s=i.WordArray,a=i.Hasher,f=o.algo,c=[];(function(){for(var E=0;E<64;E++)c[E]=r.abs(r.sin(E+1))*4294967296|0})();var x=f.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(E,p){for(var y=0;y<16;y++){var w=p+y,g=E[w];E[w]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var v=this._hash.words,b=E[p+0],C=E[p+1],F=E[p+2],_=E[p+3],I=E[p+4],A=E[p+5],D=E[p+6],H=E[p+7],B=E[p+8],k=E[p+9],S=E[p+10],T=E[p+11],P=E[p+12],O=E[p+13],N=E[p+14],U=E[p+15],m=v[0],$=v[1],L=v[2],R=v[3];m=h(m,$,L,R,b,7,c[0]),R=h(R,m,$,L,C,12,c[1]),L=h(L,R,m,$,F,17,c[2]),$=h($,L,R,m,_,22,c[3]),m=h(m,$,L,R,I,7,c[4]),R=h(R,m,$,L,A,12,c[5]),L=h(L,R,m,$,D,17,c[6]),$=h($,L,R,m,H,22,c[7]),m=h(m,$,L,R,B,7,c[8]),R=h(R,m,$,L,k,12,c[9]),L=h(L,R,m,$,S,17,c[10]),$=h($,L,R,m,T,22,c[11]),m=h(m,$,L,R,P,7,c[12]),R=h(R,m,$,L,O,12,c[13]),L=h(L,R,m,$,N,17,c[14]),$=h($,L,R,m,U,22,c[15]),m=u(m,$,L,R,C,5,c[16]),R=u(R,m,$,L,D,9,c[17]),L=u(L,R,m,$,T,14,c[18]),$=u($,L,R,m,b,20,c[19]),m=u(m,$,L,R,A,5,c[20]),R=u(R,m,$,L,S,9,c[21]),L=u(L,R,m,$,U,14,c[22]),$=u($,L,R,m,I,20,c[23]),m=u(m,$,L,R,k,5,c[24]),R=u(R,m,$,L,N,9,c[25]),L=u(L,R,m,$,_,14,c[26]),$=u($,L,R,m,B,20,c[27]),m=u(m,$,L,R,O,5,c[28]),R=u(R,m,$,L,F,9,c[29]),L=u(L,R,m,$,H,14,c[30]),$=u($,L,R,m,P,20,c[31]),m=d(m,$,L,R,A,4,c[32]),R=d(R,m,$,L,B,11,c[33]),L=d(L,R,m,$,T,16,c[34]),$=d($,L,R,m,N,23,c[35]),m=d(m,$,L,R,C,4,c[36]),R=d(R,m,$,L,I,11,c[37]),L=d(L,R,m,$,H,16,c[38]),$=d($,L,R,m,S,23,c[39]),m=d(m,$,L,R,O,4,c[40]),R=d(R,m,$,L,b,11,c[41]),L=d(L,R,m,$,_,16,c[42]),$=d($,L,R,m,D,23,c[43]),m=d(m,$,L,R,k,4,c[44]),R=d(R,m,$,L,P,11,c[45]),L=d(L,R,m,$,U,16,c[46]),$=d($,L,R,m,F,23,c[47]),m=l(m,$,L,R,b,6,c[48]),R=l(R,m,$,L,H,10,c[49]),L=l(L,R,m,$,N,15,c[50]),$=l($,L,R,m,A,21,c[51]),m=l(m,$,L,R,P,6,c[52]),R=l(R,m,$,L,_,10,c[53]),L=l(L,R,m,$,S,15,c[54]),$=l($,L,R,m,C,21,c[55]),m=l(m,$,L,R,B,6,c[56]),R=l(R,m,$,L,U,10,c[57]),L=l(L,R,m,$,D,15,c[58]),$=l($,L,R,m,O,21,c[59]),m=l(m,$,L,R,I,6,c[60]),R=l(R,m,$,L,T,10,c[61]),L=l(L,R,m,$,F,15,c[62]),$=l($,L,R,m,k,21,c[63]),v[0]=v[0]+m|0,v[1]=v[1]+$|0,v[2]=v[2]+L|0,v[3]=v[3]+R|0},_doFinalize:function(){var E=this._data,p=E.words,y=this._nDataBytes*8,w=E.sigBytes*8;p[w>>>5]|=128<<24-w%32;var g=r.floor(y/4294967296),v=y;p[(w+64>>>9<<4)+15]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,p[(w+64>>>9<<4)+14]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,E.sigBytes=(p.length+1)*4,this._process();for(var b=this._hash,C=b.words,F=0;F<4;F++){var _=C[F];C[F]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360}return b},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function h(E,p,y,w,g,v,b){var C=E+(p&y|~p&w)+g+b;return(C<<v|C>>>32-v)+p}function u(E,p,y,w,g,v,b){var C=E+(p&w|y&~w)+g+b;return(C<<v|C>>>32-v)+p}function d(E,p,y,w,g,v,b){var C=E+(p^y^w)+g+b;return(C<<v|C>>>32-v)+p}function l(E,p,y,w,g,v,b){var C=E+(y^(p|~w))+g+b;return(C<<v|C>>>32-v)+p}o.MD5=a._createHelper(x),o.HmacMD5=a._createHmacHelper(x)})(Math),n.MD5})})(st)),st.exports}var at={exports:{}},Ss=at.exports,mn;function Po(){return mn||(mn=1,(function(e,t){(function(n,r){e.exports=r(V())})(Ss,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=o.Hasher,a=r.algo,f=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(x,h){for(var u=this._hash.words,d=u[0],l=u[1],E=u[2],p=u[3],y=u[4],w=0;w<80;w++){if(w<16)f[w]=x[h+w]|0;else{var g=f[w-3]^f[w-8]^f[w-14]^f[w-16];f[w]=g<<1|g>>>31}var v=(d<<5|d>>>27)+y+f[w];w<20?v+=(l&E|~l&p)+1518500249:w<40?v+=(l^E^p)+1859775393:w<60?v+=(l&E|l&p|E&p)-1894007588:v+=(l^E^p)-899497514,y=p,p=E,E=l<<30|l>>>2,l=d,d=v}u[0]=u[0]+d|0,u[1]=u[1]+l|0,u[2]=u[2]+E|0,u[3]=u[3]+p|0,u[4]=u[4]+y|0},_doFinalize:function(){var x=this._data,h=x.words,u=this._nDataBytes*8,d=x.sigBytes*8;return h[d>>>5]|=128<<24-d%32,h[(d+64>>>9<<4)+14]=Math.floor(u/4294967296),h[(d+64>>>9<<4)+15]=u,x.sigBytes=h.length*4,this._process(),this._hash},clone:function(){var x=s.clone.call(this);return x._hash=this._hash.clone(),x}});r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c)})(),n.SHA1})})(at)),at.exports}var ct={exports:{}},_s=ct.exports,Dn;function Lr(){return Dn||(Dn=1,(function(e,t){(function(n,r){e.exports=r(V())})(_s,function(n){return(function(r){var o=n,i=o.lib,s=i.WordArray,a=i.Hasher,f=o.algo,c=[],x=[];(function(){function d(y){for(var w=r.sqrt(y),g=2;g<=w;g++)if(!(y%g))return!1;return!0}function l(y){return(y-(y|0))*4294967296|0}for(var E=2,p=0;p<64;)d(E)&&(p<8&&(c[p]=l(r.pow(E,1/2))),x[p]=l(r.pow(E,1/3)),p++),E++})();var h=[],u=f.SHA256=a.extend({_doReset:function(){this._hash=new s.init(c.slice(0))},_doProcessBlock:function(d,l){for(var E=this._hash.words,p=E[0],y=E[1],w=E[2],g=E[3],v=E[4],b=E[5],C=E[6],F=E[7],_=0;_<64;_++){if(_<16)h[_]=d[l+_]|0;else{var I=h[_-15],A=(I<<25|I>>>7)^(I<<14|I>>>18)^I>>>3,D=h[_-2],H=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;h[_]=A+h[_-7]+H+h[_-16]}var B=v&b^~v&C,k=p&y^p&w^y&w,S=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),T=(v<<26|v>>>6)^(v<<21|v>>>11)^(v<<7|v>>>25),P=F+T+B+x[_]+h[_],O=S+k;F=C,C=b,b=v,v=g+P|0,g=w,w=y,y=p,p=P+O|0}E[0]=E[0]+p|0,E[1]=E[1]+y|0,E[2]=E[2]+w|0,E[3]=E[3]+g|0,E[4]=E[4]+v|0,E[5]=E[5]+b|0,E[6]=E[6]+C|0,E[7]=E[7]+F|0},_doFinalize:function(){var d=this._data,l=d.words,E=this._nDataBytes*8,p=d.sigBytes*8;return l[p>>>5]|=128<<24-p%32,l[(p+64>>>9<<4)+14]=r.floor(E/4294967296),l[(p+64>>>9<<4)+15]=E,d.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var d=a.clone.call(this);return d._hash=this._hash.clone(),d}});o.SHA256=a._createHelper(u),o.HmacSHA256=a._createHmacHelper(u)})(Math),n.SHA256})})(ct)),ct.exports}var ft={exports:{}},ks=ft.exports,Fn;function Hs(){return Fn||(Fn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Lr())})(ks,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=r.algo,a=s.SHA256,f=s.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(f),r.HmacSHA224=a._createHmacHelper(f)})(),n.SHA224})})(ft)),ft.exports}var xt={exports:{}},$s=xt.exports,Sn;function No(){return Sn||(Sn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Jt())})($s,function(n){return(function(){var r=n,o=r.lib,i=o.Hasher,s=r.x64,a=s.Word,f=s.WordArray,c=r.algo;function x(){return a.create.apply(a,arguments)}var h=[x(1116352408,3609767458),x(1899447441,602891725),x(3049323471,3964484399),x(3921009573,2173295548),x(961987163,4081628472),x(1508970993,3053834265),x(2453635748,2937671579),x(2870763221,3664609560),x(3624381080,2734883394),x(310598401,1164996542),x(607225278,1323610764),x(1426881987,3590304994),x(1925078388,4068182383),x(2162078206,991336113),x(2614888103,633803317),x(3248222580,3479774868),x(3835390401,2666613458),x(4022224774,944711139),x(264347078,2341262773),x(604807628,2007800933),x(770255983,1495990901),x(1249150122,1856431235),x(1555081692,3175218132),x(1996064986,2198950837),x(2554220882,3999719339),x(2821834349,766784016),x(2952996808,2566594879),x(3210313671,3203337956),x(3336571891,1034457026),x(3584528711,2466948901),x(113926993,3758326383),x(338241895,168717936),x(666307205,1188179964),x(773529912,1546045734),x(1294757372,1522805485),x(1396182291,2643833823),x(1695183700,2343527390),x(1986661051,1014477480),x(2177026350,1206759142),x(2456956037,344077627),x(2730485921,1290863460),x(2820302411,3158454273),x(3259730800,3505952657),x(3345764771,106217008),x(3516065817,3606008344),x(3600352804,1432725776),x(4094571909,1467031594),x(275423344,851169720),x(430227734,3100823752),x(506948616,1363258195),x(659060556,3750685593),x(883997877,3785050280),x(958139571,3318307427),x(1322822218,3812723403),x(1537002063,2003034995),x(1747873779,3602036899),x(1955562222,1575990012),x(2024104815,1125592928),x(2227730452,2716904306),x(2361852424,442776044),x(2428436474,593698344),x(2756734187,3733110249),x(3204031479,2999351573),x(3329325298,3815920427),x(3391569614,3928383900),x(3515267271,566280711),x(3940187606,3454069534),x(4118630271,4000239992),x(116418474,1914138554),x(174292421,2731055270),x(289380356,3203993006),x(460393269,320620315),x(685471733,587496836),x(852142971,1086792851),x(1017036298,365543100),x(1126000580,2618297676),x(1288033470,3409855158),x(1501505948,4234509866),x(1607167915,987167468),x(1816402316,1246189591)],u=[];(function(){for(var l=0;l<80;l++)u[l]=x()})();var d=c.SHA512=i.extend({_doReset:function(){this._hash=new f.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(l,E){for(var p=this._hash.words,y=p[0],w=p[1],g=p[2],v=p[3],b=p[4],C=p[5],F=p[6],_=p[7],I=y.high,A=y.low,D=w.high,H=w.low,B=g.high,k=g.low,S=v.high,T=v.low,P=b.high,O=b.low,N=C.high,U=C.low,m=F.high,$=F.low,L=_.high,R=_.low,q=I,W=A,M=D,z=H,G=B,X=k,Te=S,Ue=T,xe=P,ge=O,W0=N,B0=U,z0=m,A0=$,ur=L,C0=R,Ae=0;Ae<80;Ae++){var ye,Oe,K0=u[Ae];if(Ae<16)Oe=K0.high=l[E+Ae*2]|0,ye=K0.low=l[E+Ae*2+1]|0;else{var sn=u[Ae-15],s0=sn.high,m0=sn.low,es=(s0>>>1|m0<<31)^(s0>>>8|m0<<24)^s0>>>7,an=(m0>>>1|s0<<31)^(m0>>>8|s0<<24)^(m0>>>7|s0<<25),cn=u[Ae-2],a0=cn.high,D0=cn.low,ts=(a0>>>19|D0<<13)^(a0<<3|D0>>>29)^a0>>>6,fn=(D0>>>19|a0<<13)^(D0<<3|a0>>>29)^(D0>>>6|a0<<26),xn=u[Ae-7],rs=xn.high,ns=xn.low,un=u[Ae-16],os=un.high,hn=un.low;ye=an+ns,Oe=es+rs+(ye>>>0<an>>>0?1:0),ye=ye+fn,Oe=Oe+ts+(ye>>>0<fn>>>0?1:0),ye=ye+hn,Oe=Oe+os+(ye>>>0<hn>>>0?1:0),K0.high=Oe,K0.low=ye}var is=xe&W0^~xe&z0,dn=ge&B0^~ge&A0,ss=q&M^q&G^M&G,as=W&z^W&X^z&X,cs=(q>>>28|W<<4)^(q<<30|W>>>2)^(q<<25|W>>>7),ln=(W>>>28|q<<4)^(W<<30|q>>>2)^(W<<25|q>>>7),fs=(xe>>>14|ge<<18)^(xe>>>18|ge<<14)^(xe<<23|ge>>>9),xs=(ge>>>14|xe<<18)^(ge>>>18|xe<<14)^(ge<<23|xe>>>9),pn=h[Ae],us=pn.high,gn=pn.low,we=C0+xs,Pe=ur+fs+(we>>>0<C0>>>0?1:0),we=we+dn,Pe=Pe+is+(we>>>0<dn>>>0?1:0),we=we+gn,Pe=Pe+us+(we>>>0<gn>>>0?1:0),we=we+ye,Pe=Pe+Oe+(we>>>0<ye>>>0?1:0),wn=ln+as,hs=cs+ss+(wn>>>0<ln>>>0?1:0);ur=z0,C0=A0,z0=W0,A0=B0,W0=xe,B0=ge,ge=Ue+we|0,xe=Te+Pe+(ge>>>0<Ue>>>0?1:0)|0,Te=G,Ue=X,G=M,X=z,M=q,z=W,W=we+wn|0,q=Pe+hs+(W>>>0<we>>>0?1:0)|0}A=y.low=A+W,y.high=I+q+(A>>>0<W>>>0?1:0),H=w.low=H+z,w.high=D+M+(H>>>0<z>>>0?1:0),k=g.low=k+X,g.high=B+G+(k>>>0<X>>>0?1:0),T=v.low=T+Ue,v.high=S+Te+(T>>>0<Ue>>>0?1:0),O=b.low=O+ge,b.high=P+xe+(O>>>0<ge>>>0?1:0),U=C.low=U+B0,C.high=N+W0+(U>>>0<B0>>>0?1:0),$=F.low=$+A0,F.high=m+z0+($>>>0<A0>>>0?1:0),R=_.low=R+C0,_.high=L+ur+(R>>>0<C0>>>0?1:0)},_doFinalize:function(){var l=this._data,E=l.words,p=this._nDataBytes*8,y=l.sigBytes*8;E[y>>>5]|=128<<24-y%32,E[(y+128>>>10<<5)+30]=Math.floor(p/4294967296),E[(y+128>>>10<<5)+31]=p,l.sigBytes=E.length*4,this._process();var w=this._hash.toX32();return w},clone:function(){var l=i.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:1024/32});r.SHA512=i._createHelper(d),r.HmacSHA512=i._createHmacHelper(d)})(),n.SHA512})})(xt)),xt.exports}var ut={exports:{}},Is=ut.exports,_n;function Rs(){return _n||(_n=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Jt(),No())})(Is,function(n){return(function(){var r=n,o=r.x64,i=o.Word,s=o.WordArray,a=r.algo,f=a.SHA512,c=a.SHA384=f.extend({_doReset:function(){this._hash=new s.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var x=f._doFinalize.call(this);return x.sigBytes-=16,x}});r.SHA384=f._createHelper(c),r.HmacSHA384=f._createHmacHelper(c)})(),n.SHA384})})(ut)),ut.exports}var ht={exports:{}},Ls=ht.exports,kn;function Ts(){return kn||(kn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Jt())})(Ls,function(n){return(function(r){var o=n,i=o.lib,s=i.WordArray,a=i.Hasher,f=o.x64,c=f.Word,x=o.algo,h=[],u=[],d=[];(function(){for(var p=1,y=0,w=0;w<24;w++){h[p+5*y]=(w+1)*(w+2)/2%64;var g=y%5,v=(2*p+3*y)%5;p=g,y=v}for(var p=0;p<5;p++)for(var y=0;y<5;y++)u[p+5*y]=y+(2*p+3*y)%5*5;for(var b=1,C=0;C<24;C++){for(var F=0,_=0,I=0;I<7;I++){if(b&1){var A=(1<<I)-1;A<32?_^=1<<A:F^=1<<A-32}b&128?b=b<<1^113:b<<=1}d[C]=c.create(F,_)}})();var l=[];(function(){for(var p=0;p<25;p++)l[p]=c.create()})();var E=x.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var p=this._state=[],y=0;y<25;y++)p[y]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(p,y){for(var w=this._state,g=this.blockSize/2,v=0;v<g;v++){var b=p[y+2*v],C=p[y+2*v+1];b=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360;var F=w[v];F.high^=C,F.low^=b}for(var _=0;_<24;_++){for(var I=0;I<5;I++){for(var A=0,D=0,H=0;H<5;H++){var F=w[I+5*H];A^=F.high,D^=F.low}var B=l[I];B.high=A,B.low=D}for(var I=0;I<5;I++)for(var k=l[(I+4)%5],S=l[(I+1)%5],T=S.high,P=S.low,A=k.high^(T<<1|P>>>31),D=k.low^(P<<1|T>>>31),H=0;H<5;H++){var F=w[I+5*H];F.high^=A,F.low^=D}for(var O=1;O<25;O++){var A,D,F=w[O],N=F.high,U=F.low,m=h[O];m<32?(A=N<<m|U>>>32-m,D=U<<m|N>>>32-m):(A=U<<m-32|N>>>64-m,D=N<<m-32|U>>>64-m);var $=l[u[O]];$.high=A,$.low=D}var L=l[0],R=w[0];L.high=R.high,L.low=R.low;for(var I=0;I<5;I++)for(var H=0;H<5;H++){var O=I+5*H,F=w[O],q=l[O],W=l[(I+1)%5+5*H],M=l[(I+2)%5+5*H];F.high=q.high^~W.high&M.high,F.low=q.low^~W.low&M.low}var F=w[0],z=d[_];F.high^=z.high,F.low^=z.low}},_doFinalize:function(){var p=this._data,y=p.words;this._nDataBytes*8;var w=p.sigBytes*8,g=this.blockSize*32;y[w>>>5]|=1<<24-w%32,y[(r.ceil((w+1)/g)*g>>>5)-1]|=128,p.sigBytes=y.length*4,this._process();for(var v=this._state,b=this.cfg.outputLength/8,C=b/8,F=[],_=0;_<C;_++){var I=v[_],A=I.high,D=I.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,F.push(D),F.push(A)}return new s.init(F,b)},clone:function(){for(var p=a.clone.call(this),y=p._state=this._state.slice(0),w=0;w<25;w++)y[w]=y[w].clone();return p}});o.SHA3=a._createHelper(E),o.HmacSHA3=a._createHmacHelper(E)})(Math),n.SHA3})})(ht)),ht.exports}var dt={exports:{}},Us=dt.exports,Hn;function Os(){return Hn||(Hn=1,(function(e,t){(function(n,r){e.exports=r(V())})(Us,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return(function(r){var o=n,i=o.lib,s=i.WordArray,a=i.Hasher,f=o.algo,c=s.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),x=s.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),h=s.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=s.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=s.create([0,1518500249,1859775393,2400959708,2840853838]),l=s.create([1352829926,1548603684,1836072691,2053994217,0]),E=f.RIPEMD160=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(C,F){for(var _=0;_<16;_++){var I=F+_,A=C[I];C[I]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var D=this._hash.words,H=d.words,B=l.words,k=c.words,S=x.words,T=h.words,P=u.words,O,N,U,m,$,L,R,q,W,M;L=O=D[0],R=N=D[1],q=U=D[2],W=m=D[3],M=$=D[4];for(var z,_=0;_<80;_+=1)z=O+C[F+k[_]]|0,_<16?z+=p(N,U,m)+H[0]:_<32?z+=y(N,U,m)+H[1]:_<48?z+=w(N,U,m)+H[2]:_<64?z+=g(N,U,m)+H[3]:z+=v(N,U,m)+H[4],z=z|0,z=b(z,T[_]),z=z+$|0,O=$,$=m,m=b(U,10),U=N,N=z,z=L+C[F+S[_]]|0,_<16?z+=v(R,q,W)+B[0]:_<32?z+=g(R,q,W)+B[1]:_<48?z+=w(R,q,W)+B[2]:_<64?z+=y(R,q,W)+B[3]:z+=p(R,q,W)+B[4],z=z|0,z=b(z,P[_]),z=z+M|0,L=M,M=W,W=b(q,10),q=R,R=z;z=D[1]+U+W|0,D[1]=D[2]+m+M|0,D[2]=D[3]+$+L|0,D[3]=D[4]+O+R|0,D[4]=D[0]+N+q|0,D[0]=z},_doFinalize:function(){var C=this._data,F=C.words,_=this._nDataBytes*8,I=C.sigBytes*8;F[I>>>5]|=128<<24-I%32,F[(I+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,C.sigBytes=(F.length+1)*4,this._process();for(var A=this._hash,D=A.words,H=0;H<5;H++){var B=D[H];D[H]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return A},clone:function(){var C=a.clone.call(this);return C._hash=this._hash.clone(),C}});function p(C,F,_){return C^F^_}function y(C,F,_){return C&F|~C&_}function w(C,F,_){return(C|~F)^_}function g(C,F,_){return C&_|F&~_}function v(C,F,_){return C^(F|~_)}function b(C,F){return C<<F|C>>>32-F}o.RIPEMD160=a._createHelper(E),o.HmacRIPEMD160=a._createHmacHelper(E)})(),n.RIPEMD160})})(dt)),dt.exports}var lt={exports:{}},Ps=lt.exports,$n;function Tr(){return $n||($n=1,(function(e,t){(function(n,r){e.exports=r(V())})(Ps,function(n){(function(){var r=n,o=r.lib,i=o.Base,s=r.enc,a=s.Utf8,f=r.algo;f.HMAC=i.extend({init:function(c,x){c=this._hasher=new c.init,typeof x=="string"&&(x=a.parse(x));var h=c.blockSize,u=h*4;x.sigBytes>u&&(x=c.finalize(x)),x.clamp();for(var d=this._oKey=x.clone(),l=this._iKey=x.clone(),E=d.words,p=l.words,y=0;y<h;y++)E[y]^=1549556828,p[y]^=909522486;d.sigBytes=l.sigBytes=u,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var x=this._hasher,h=x.finalize(c);x.reset();var u=x.finalize(this._oKey.clone().concat(h));return u}})})()})})(lt)),lt.exports}var pt={exports:{}},Ns=pt.exports,In;function qs(){return In||(In=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Lr(),Tr())})(Ns,function(n){return(function(){var r=n,o=r.lib,i=o.Base,s=o.WordArray,a=r.algo,f=a.SHA256,c=a.HMAC,x=a.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:f,iterations:25e4}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,u){for(var d=this.cfg,l=c.create(d.hasher,h),E=s.create(),p=s.create([1]),y=E.words,w=p.words,g=d.keySize,v=d.iterations;y.length<g;){var b=l.update(u).finalize(p);l.reset();for(var C=b.words,F=C.length,_=b,I=1;I<v;I++){_=l.finalize(_),l.reset();for(var A=_.words,D=0;D<F;D++)C[D]^=A[D]}E.concat(b),w[0]++}return E.sigBytes=g*4,E}});r.PBKDF2=function(h,u,d){return x.create(d).compute(h,u)}})(),n.PBKDF2})})(pt)),pt.exports}var gt={exports:{}},Ws=gt.exports,Rn;function Ge(){return Rn||(Rn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Po(),Tr())})(Ws,function(n){return(function(){var r=n,o=r.lib,i=o.Base,s=o.WordArray,a=r.algo,f=a.MD5,c=a.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:f,iterations:1}),init:function(x){this.cfg=this.cfg.extend(x)},compute:function(x,h){for(var u,d=this.cfg,l=d.hasher.create(),E=s.create(),p=E.words,y=d.keySize,w=d.iterations;p.length<y;){u&&l.update(u),u=l.update(x).finalize(h),l.reset();for(var g=1;g<w;g++)u=l.finalize(u),l.reset();E.concat(u)}return E.sigBytes=y*4,E}});r.EvpKDF=function(x,h,u){return c.create(u).compute(x,h)}})(),n.EvpKDF})})(gt)),gt.exports}var wt={exports:{}},zs=wt.exports,Ln;function oe(){return Ln||(Ln=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Ge())})(zs,function(n){n.lib.Cipher||(function(r){var o=n,i=o.lib,s=i.Base,a=i.WordArray,f=i.BufferedBlockAlgorithm,c=o.enc;c.Utf8;var x=c.Base64,h=o.algo,u=h.EvpKDF,d=i.Cipher=f.extend({cfg:s.extend(),createEncryptor:function(A,D){return this.create(this._ENC_XFORM_MODE,A,D)},createDecryptor:function(A,D){return this.create(this._DEC_XFORM_MODE,A,D)},init:function(A,D,H){this.cfg=this.cfg.extend(H),this._xformMode=A,this._key=D,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var D=this._doFinalize();return D},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function A(D){return typeof D=="string"?I:C}return function(D){return{encrypt:function(H,B,k){return A(B).encrypt(D,H,B,k)},decrypt:function(H,B,k){return A(B).decrypt(D,H,B,k)}}}})()});i.StreamCipher=d.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1});var l=o.mode={},E=i.BlockCipherMode=s.extend({createEncryptor:function(A,D){return this.Encryptor.create(A,D)},createDecryptor:function(A,D){return this.Decryptor.create(A,D)},init:function(A,D){this._cipher=A,this._iv=D}}),p=l.CBC=(function(){var A=E.extend();A.Encryptor=A.extend({processBlock:function(H,B){var k=this._cipher,S=k.blockSize;D.call(this,H,B,S),k.encryptBlock(H,B),this._prevBlock=H.slice(B,B+S)}}),A.Decryptor=A.extend({processBlock:function(H,B){var k=this._cipher,S=k.blockSize,T=H.slice(B,B+S);k.decryptBlock(H,B),D.call(this,H,B,S),this._prevBlock=T}});function D(H,B,k){var S,T=this._iv;T?(S=T,this._iv=r):S=this._prevBlock;for(var P=0;P<k;P++)H[B+P]^=S[P]}return A})(),y=o.pad={},w=y.Pkcs7={pad:function(A,D){for(var H=D*4,B=H-A.sigBytes%H,k=B<<24|B<<16|B<<8|B,S=[],T=0;T<B;T+=4)S.push(k);var P=a.create(S,B);A.concat(P)},unpad:function(A){var D=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=D}};i.BlockCipher=d.extend({cfg:d.cfg.extend({mode:p,padding:w}),reset:function(){var A;d.reset.call(this);var D=this.cfg,H=D.iv,B=D.mode;this._xformMode==this._ENC_XFORM_MODE?A=B.createEncryptor:(A=B.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,H&&H.words):(this._mode=A.call(B,this,H&&H.words),this._mode.__creator=A)},_doProcessBlock:function(A,D){this._mode.processBlock(A,D)},_doFinalize:function(){var A,D=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(D.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),D.unpad(A)),A},blockSize:128/32});var g=i.CipherParams=s.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),v=o.format={},b=v.OpenSSL={stringify:function(A){var D,H=A.ciphertext,B=A.salt;return B?D=a.create([1398893684,1701076831]).concat(B).concat(H):D=H,D.toString(x)},parse:function(A){var D,H=x.parse(A),B=H.words;return B[0]==1398893684&&B[1]==1701076831&&(D=a.create(B.slice(2,4)),B.splice(0,4),H.sigBytes-=16),g.create({ciphertext:H,salt:D})}},C=i.SerializableCipher=s.extend({cfg:s.extend({format:b}),encrypt:function(A,D,H,B){B=this.cfg.extend(B);var k=A.createEncryptor(H,B),S=k.finalize(D),T=k.cfg;return g.create({ciphertext:S,key:H,iv:T.iv,algorithm:A,mode:T.mode,padding:T.padding,blockSize:A.blockSize,formatter:B.format})},decrypt:function(A,D,H,B){B=this.cfg.extend(B),D=this._parse(D,B.format);var k=A.createDecryptor(H,B).finalize(D.ciphertext);return k},_parse:function(A,D){return typeof A=="string"?D.parse(A,this):A}}),F=o.kdf={},_=F.OpenSSL={execute:function(A,D,H,B,k){if(B||(B=a.random(64/8)),k)var S=u.create({keySize:D+H,hasher:k}).compute(A,B);else var S=u.create({keySize:D+H}).compute(A,B);var T=a.create(S.words.slice(D),H*4);return S.sigBytes=D*4,g.create({key:S,iv:T,salt:B})}},I=i.PasswordBasedCipher=C.extend({cfg:C.cfg.extend({kdf:_}),encrypt:function(A,D,H,B){B=this.cfg.extend(B);var k=B.kdf.execute(H,A.keySize,A.ivSize,B.salt,B.hasher);B.iv=k.iv;var S=C.encrypt.call(this,A,D,k.key,B);return S.mixIn(k),S},decrypt:function(A,D,H,B){B=this.cfg.extend(B),D=this._parse(D,B.format);var k=B.kdf.execute(H,A.keySize,A.ivSize,D.salt,B.hasher);B.iv=k.iv;var S=C.decrypt.call(this,A,D,k.key,B);return S}})})()})})(wt)),wt.exports}var Et={exports:{}},Ks=Et.exports,Tn;function Vs(){return Tn||(Tn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(Ks,function(n){return n.mode.CFB=(function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,s){var a=this._cipher,f=a.blockSize;o.call(this,i,s,f,a),this._prevBlock=i.slice(s,s+f)}}),r.Decryptor=r.extend({processBlock:function(i,s){var a=this._cipher,f=a.blockSize,c=i.slice(s,s+f);o.call(this,i,s,f,a),this._prevBlock=c}});function o(i,s,a,f){var c,x=this._iv;x?(c=x.slice(0),this._iv=void 0):c=this._prevBlock,f.encryptBlock(c,0);for(var h=0;h<a;h++)i[s+h]^=c[h]}return r})(),n.mode.CFB})})(Et)),Et.exports}var vt={exports:{}},Ms=vt.exports,Un;function Gs(){return Un||(Un=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(Ms,function(n){return n.mode.CTR=(function(){var r=n.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(i,s){var a=this._cipher,f=a.blockSize,c=this._iv,x=this._counter;c&&(x=this._counter=c.slice(0),this._iv=void 0);var h=x.slice(0);a.encryptBlock(h,0),x[f-1]=x[f-1]+1|0;for(var u=0;u<f;u++)i[s+u]^=h[u]}});return r.Decryptor=o,r})(),n.mode.CTR})})(vt)),vt.exports}var yt={exports:{}},Ys=yt.exports,On;function js(){return On||(On=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(Ys,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=(function(){var r=n.lib.BlockCipherMode.extend();function o(a){if((a>>24&255)===255){var f=a>>16&255,c=a>>8&255,x=a&255;f===255?(f=0,c===255?(c=0,x===255?x=0:++x):++c):++f,a=0,a+=f<<16,a+=c<<8,a+=x}else a+=1<<24;return a}function i(a){return(a[0]=o(a[0]))===0&&(a[1]=o(a[1])),a}var s=r.Encryptor=r.extend({processBlock:function(a,f){var c=this._cipher,x=c.blockSize,h=this._iv,u=this._counter;h&&(u=this._counter=h.slice(0),this._iv=void 0),i(u);var d=u.slice(0);c.encryptBlock(d,0);for(var l=0;l<x;l++)a[f+l]^=d[l]}});return r.Decryptor=s,r})(),n.mode.CTRGladman})})(yt)),yt.exports}var bt={exports:{}},Zs=bt.exports,Pn;function Xs(){return Pn||(Pn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(Zs,function(n){return n.mode.OFB=(function(){var r=n.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(i,s){var a=this._cipher,f=a.blockSize,c=this._iv,x=this._keystream;c&&(x=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(x,0);for(var h=0;h<f;h++)i[s+h]^=x[h]}});return r.Decryptor=o,r})(),n.mode.OFB})})(bt)),bt.exports}var Bt={exports:{}},Qs=Bt.exports,Nn;function Js(){return Nn||(Nn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(Qs,function(n){return n.mode.ECB=(function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(o,i){this._cipher.encryptBlock(o,i)}}),r.Decryptor=r.extend({processBlock:function(o,i){this._cipher.decryptBlock(o,i)}}),r})(),n.mode.ECB})})(Bt)),Bt.exports}var At={exports:{}},ea=At.exports,qn;function ta(){return qn||(qn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(ea,function(n){return n.pad.AnsiX923={pad:function(r,o){var i=r.sigBytes,s=o*4,a=s-i%s,f=i+a-1;r.clamp(),r.words[f>>>2]|=a<<24-f%4*8,r.sigBytes+=a},unpad:function(r){var o=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=o}},n.pad.Ansix923})})(At)),At.exports}var Ct={exports:{}},ra=Ct.exports,Wn;function na(){return Wn||(Wn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(ra,function(n){return n.pad.Iso10126={pad:function(r,o){var i=o*4,s=i-r.sigBytes%i;r.concat(n.lib.WordArray.random(s-1)).concat(n.lib.WordArray.create([s<<24],1))},unpad:function(r){var o=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=o}},n.pad.Iso10126})})(Ct)),Ct.exports}var mt={exports:{}},oa=mt.exports,zn;function ia(){return zn||(zn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(oa,function(n){return n.pad.Iso97971={pad:function(r,o){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,o)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})})(mt)),mt.exports}var Dt={exports:{}},sa=Dt.exports,Kn;function aa(){return Kn||(Kn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(sa,function(n){return n.pad.ZeroPadding={pad:function(r,o){var i=o*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var o=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(o[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},n.pad.ZeroPadding})})(Dt)),Dt.exports}var Ft={exports:{}},ca=Ft.exports,Vn;function fa(){return Vn||(Vn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(ca,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})})(Ft)),Ft.exports}var St={exports:{}},xa=St.exports,Mn;function ua(){return Mn||(Mn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),oe())})(xa,function(n){return(function(r){var o=n,i=o.lib,s=i.CipherParams,a=o.enc,f=a.Hex,c=o.format;c.Hex={stringify:function(x){return x.ciphertext.toString(f)},parse:function(x){var h=f.parse(x);return s.create({ciphertext:h})}}})(),n.format.Hex})})(St)),St.exports}var _t={exports:{}},ha=_t.exports,Gn;function da(){return Gn||(Gn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(ha,function(n){return(function(){var r=n,o=r.lib,i=o.BlockCipher,s=r.algo,a=[],f=[],c=[],x=[],h=[],u=[],d=[],l=[],E=[],p=[];(function(){for(var g=[],v=0;v<256;v++)v<128?g[v]=v<<1:g[v]=v<<1^283;for(var b=0,C=0,v=0;v<256;v++){var F=C^C<<1^C<<2^C<<3^C<<4;F=F>>>8^F&255^99,a[b]=F,f[F]=b;var _=g[b],I=g[_],A=g[I],D=g[F]*257^F*16843008;c[b]=D<<24|D>>>8,x[b]=D<<16|D>>>16,h[b]=D<<8|D>>>24,u[b]=D;var D=A*16843009^I*65537^_*257^b*16843008;d[F]=D<<24|D>>>8,l[F]=D<<16|D>>>16,E[F]=D<<8|D>>>24,p[F]=D,b?(b=_^g[g[g[A^_]]],C^=g[g[C]]):b=C=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],w=s.AES=i.extend({_doReset:function(){var g;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var v=this._keyPriorReset=this._key,b=v.words,C=v.sigBytes/4,F=this._nRounds=C+6,_=(F+1)*4,I=this._keySchedule=[],A=0;A<_;A++)A<C?I[A]=b[A]:(g=I[A-1],A%C?C>6&&A%C==4&&(g=a[g>>>24]<<24|a[g>>>16&255]<<16|a[g>>>8&255]<<8|a[g&255]):(g=g<<8|g>>>24,g=a[g>>>24]<<24|a[g>>>16&255]<<16|a[g>>>8&255]<<8|a[g&255],g^=y[A/C|0]<<24),I[A]=I[A-C]^g);for(var D=this._invKeySchedule=[],H=0;H<_;H++){var A=_-H;if(H%4)var g=I[A];else var g=I[A-4];H<4||A<=4?D[H]=g:D[H]=d[a[g>>>24]]^l[a[g>>>16&255]]^E[a[g>>>8&255]]^p[a[g&255]]}}},encryptBlock:function(g,v){this._doCryptBlock(g,v,this._keySchedule,c,x,h,u,a)},decryptBlock:function(g,v){var b=g[v+1];g[v+1]=g[v+3],g[v+3]=b,this._doCryptBlock(g,v,this._invKeySchedule,d,l,E,p,f);var b=g[v+1];g[v+1]=g[v+3],g[v+3]=b},_doCryptBlock:function(g,v,b,C,F,_,I,A){for(var D=this._nRounds,H=g[v]^b[0],B=g[v+1]^b[1],k=g[v+2]^b[2],S=g[v+3]^b[3],T=4,P=1;P<D;P++){var O=C[H>>>24]^F[B>>>16&255]^_[k>>>8&255]^I[S&255]^b[T++],N=C[B>>>24]^F[k>>>16&255]^_[S>>>8&255]^I[H&255]^b[T++],U=C[k>>>24]^F[S>>>16&255]^_[H>>>8&255]^I[B&255]^b[T++],m=C[S>>>24]^F[H>>>16&255]^_[B>>>8&255]^I[k&255]^b[T++];H=O,B=N,k=U,S=m}var O=(A[H>>>24]<<24|A[B>>>16&255]<<16|A[k>>>8&255]<<8|A[S&255])^b[T++],N=(A[B>>>24]<<24|A[k>>>16&255]<<16|A[S>>>8&255]<<8|A[H&255])^b[T++],U=(A[k>>>24]<<24|A[S>>>16&255]<<16|A[H>>>8&255]<<8|A[B&255])^b[T++],m=(A[S>>>24]<<24|A[H>>>16&255]<<16|A[B>>>8&255]<<8|A[k&255])^b[T++];g[v]=O,g[v+1]=N,g[v+2]=U,g[v+3]=m},keySize:256/32});r.AES=i._createHelper(w)})(),n.AES})})(_t)),_t.exports}var kt={exports:{}},la=kt.exports,Yn;function pa(){return Yn||(Yn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(la,function(n){return(function(){var r=n,o=r.lib,i=o.WordArray,s=o.BlockCipher,a=r.algo,f=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],x=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=a.DES=s.extend({_doReset:function(){for(var y=this._key,w=y.words,g=[],v=0;v<56;v++){var b=f[v]-1;g[v]=w[b>>>5]>>>31-b%32&1}for(var C=this._subKeys=[],F=0;F<16;F++){for(var _=C[F]=[],I=x[F],v=0;v<24;v++)_[v/6|0]|=g[(c[v]-1+I)%28]<<31-v%6,_[4+(v/6|0)]|=g[28+(c[v+24]-1+I)%28]<<31-v%6;_[0]=_[0]<<1|_[0]>>>31;for(var v=1;v<7;v++)_[v]=_[v]>>>(v-1)*4+3;_[7]=_[7]<<5|_[7]>>>27}for(var A=this._invSubKeys=[],v=0;v<16;v++)A[v]=C[15-v]},encryptBlock:function(y,w){this._doCryptBlock(y,w,this._subKeys)},decryptBlock:function(y,w){this._doCryptBlock(y,w,this._invSubKeys)},_doCryptBlock:function(y,w,g){this._lBlock=y[w],this._rBlock=y[w+1],l.call(this,4,252645135),l.call(this,16,65535),E.call(this,2,858993459),E.call(this,8,16711935),l.call(this,1,1431655765);for(var v=0;v<16;v++){for(var b=g[v],C=this._lBlock,F=this._rBlock,_=0,I=0;I<8;I++)_|=h[I][((F^b[I])&u[I])>>>0];this._lBlock=F,this._rBlock=C^_}var A=this._lBlock;this._lBlock=this._rBlock,this._rBlock=A,l.call(this,1,1431655765),E.call(this,8,16711935),E.call(this,2,858993459),l.call(this,16,65535),l.call(this,4,252645135),y[w]=this._lBlock,y[w+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function l(y,w){var g=(this._lBlock>>>y^this._rBlock)&w;this._rBlock^=g,this._lBlock^=g<<y}function E(y,w){var g=(this._rBlock>>>y^this._lBlock)&w;this._lBlock^=g,this._rBlock^=g<<y}r.DES=s._createHelper(d);var p=a.TripleDES=s.extend({_doReset:function(){var y=this._key,w=y.words;if(w.length!==2&&w.length!==4&&w.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var g=w.slice(0,2),v=w.length<4?w.slice(0,2):w.slice(2,4),b=w.length<6?w.slice(0,2):w.slice(4,6);this._des1=d.createEncryptor(i.create(g)),this._des2=d.createEncryptor(i.create(v)),this._des3=d.createEncryptor(i.create(b))},encryptBlock:function(y,w){this._des1.encryptBlock(y,w),this._des2.decryptBlock(y,w),this._des3.encryptBlock(y,w)},decryptBlock:function(y,w){this._des3.decryptBlock(y,w),this._des2.encryptBlock(y,w),this._des1.decryptBlock(y,w)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=s._createHelper(p)})(),n.TripleDES})})(kt)),kt.exports}var Ht={exports:{}},ga=Ht.exports,jn;function wa(){return jn||(jn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(ga,function(n){return(function(){var r=n,o=r.lib,i=o.StreamCipher,s=r.algo,a=s.RC4=i.extend({_doReset:function(){for(var x=this._key,h=x.words,u=x.sigBytes,d=this._S=[],l=0;l<256;l++)d[l]=l;for(var l=0,E=0;l<256;l++){var p=l%u,y=h[p>>>2]>>>24-p%4*8&255;E=(E+d[l]+y)%256;var w=d[l];d[l]=d[E],d[E]=w}this._i=this._j=0},_doProcessBlock:function(x,h){x[h]^=f.call(this)},keySize:256/32,ivSize:0});function f(){for(var x=this._S,h=this._i,u=this._j,d=0,l=0;l<4;l++){h=(h+1)%256,u=(u+x[h])%256;var E=x[h];x[h]=x[u],x[u]=E,d|=x[(x[h]+x[u])%256]<<24-l*8}return this._i=h,this._j=u,d}r.RC4=i._createHelper(a);var c=s.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var x=this.cfg.drop;x>0;x--)f.call(this)}});r.RC4Drop=i._createHelper(c)})(),n.RC4})})(Ht)),Ht.exports}var $t={exports:{}},Ea=$t.exports,Zn;function va(){return Zn||(Zn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(Ea,function(n){return(function(){var r=n,o=r.lib,i=o.StreamCipher,s=r.algo,a=[],f=[],c=[],x=s.Rabbit=i.extend({_doReset:function(){for(var u=this._key.words,d=this.cfg.iv,l=0;l<4;l++)u[l]=(u[l]<<8|u[l]>>>24)&16711935|(u[l]<<24|u[l]>>>8)&4278255360;var E=this._X=[u[0],u[3]<<16|u[2]>>>16,u[1],u[0]<<16|u[3]>>>16,u[2],u[1]<<16|u[0]>>>16,u[3],u[2]<<16|u[1]>>>16],p=this._C=[u[2]<<16|u[2]>>>16,u[0]&4294901760|u[1]&65535,u[3]<<16|u[3]>>>16,u[1]&4294901760|u[2]&65535,u[0]<<16|u[0]>>>16,u[2]&4294901760|u[3]&65535,u[1]<<16|u[1]>>>16,u[3]&4294901760|u[0]&65535];this._b=0;for(var l=0;l<4;l++)h.call(this);for(var l=0;l<8;l++)p[l]^=E[l+4&7];if(d){var y=d.words,w=y[0],g=y[1],v=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,C=v>>>16|b&4294901760,F=b<<16|v&65535;p[0]^=v,p[1]^=C,p[2]^=b,p[3]^=F,p[4]^=v,p[5]^=C,p[6]^=b,p[7]^=F;for(var l=0;l<4;l++)h.call(this)}},_doProcessBlock:function(u,d){var l=this._X;h.call(this),a[0]=l[0]^l[5]>>>16^l[3]<<16,a[1]=l[2]^l[7]>>>16^l[5]<<16,a[2]=l[4]^l[1]>>>16^l[7]<<16,a[3]=l[6]^l[3]>>>16^l[1]<<16;for(var E=0;E<4;E++)a[E]=(a[E]<<8|a[E]>>>24)&16711935|(a[E]<<24|a[E]>>>8)&4278255360,u[d+E]^=a[E]},blockSize:128/32,ivSize:64/32});function h(){for(var u=this._X,d=this._C,l=0;l<8;l++)f[l]=d[l];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<f[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<f[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<f[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<f[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<f[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<f[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<f[6]>>>0?1:0)|0,this._b=d[7]>>>0<f[7]>>>0?1:0;for(var l=0;l<8;l++){var E=u[l]+d[l],p=E&65535,y=E>>>16,w=((p*p>>>17)+p*y>>>15)+y*y,g=((E&4294901760)*E|0)+((E&65535)*E|0);c[l]=w^g}u[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,u[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,u[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,u[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,u[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,u[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,u[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,u[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=i._createHelper(x)})(),n.Rabbit})})($t)),$t.exports}var It={exports:{}},ya=It.exports,Xn;function ba(){return Xn||(Xn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(ya,function(n){return(function(){var r=n,o=r.lib,i=o.StreamCipher,s=r.algo,a=[],f=[],c=[],x=s.RabbitLegacy=i.extend({_doReset:function(){var u=this._key.words,d=this.cfg.iv,l=this._X=[u[0],u[3]<<16|u[2]>>>16,u[1],u[0]<<16|u[3]>>>16,u[2],u[1]<<16|u[0]>>>16,u[3],u[2]<<16|u[1]>>>16],E=this._C=[u[2]<<16|u[2]>>>16,u[0]&4294901760|u[1]&65535,u[3]<<16|u[3]>>>16,u[1]&4294901760|u[2]&65535,u[0]<<16|u[0]>>>16,u[2]&4294901760|u[3]&65535,u[1]<<16|u[1]>>>16,u[3]&4294901760|u[0]&65535];this._b=0;for(var p=0;p<4;p++)h.call(this);for(var p=0;p<8;p++)E[p]^=l[p+4&7];if(d){var y=d.words,w=y[0],g=y[1],v=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,C=v>>>16|b&4294901760,F=b<<16|v&65535;E[0]^=v,E[1]^=C,E[2]^=b,E[3]^=F,E[4]^=v,E[5]^=C,E[6]^=b,E[7]^=F;for(var p=0;p<4;p++)h.call(this)}},_doProcessBlock:function(u,d){var l=this._X;h.call(this),a[0]=l[0]^l[5]>>>16^l[3]<<16,a[1]=l[2]^l[7]>>>16^l[5]<<16,a[2]=l[4]^l[1]>>>16^l[7]<<16,a[3]=l[6]^l[3]>>>16^l[1]<<16;for(var E=0;E<4;E++)a[E]=(a[E]<<8|a[E]>>>24)&16711935|(a[E]<<24|a[E]>>>8)&4278255360,u[d+E]^=a[E]},blockSize:128/32,ivSize:64/32});function h(){for(var u=this._X,d=this._C,l=0;l<8;l++)f[l]=d[l];d[0]=d[0]+1295307597+this._b|0,d[1]=d[1]+3545052371+(d[0]>>>0<f[0]>>>0?1:0)|0,d[2]=d[2]+886263092+(d[1]>>>0<f[1]>>>0?1:0)|0,d[3]=d[3]+1295307597+(d[2]>>>0<f[2]>>>0?1:0)|0,d[4]=d[4]+3545052371+(d[3]>>>0<f[3]>>>0?1:0)|0,d[5]=d[5]+886263092+(d[4]>>>0<f[4]>>>0?1:0)|0,d[6]=d[6]+1295307597+(d[5]>>>0<f[5]>>>0?1:0)|0,d[7]=d[7]+3545052371+(d[6]>>>0<f[6]>>>0?1:0)|0,this._b=d[7]>>>0<f[7]>>>0?1:0;for(var l=0;l<8;l++){var E=u[l]+d[l],p=E&65535,y=E>>>16,w=((p*p>>>17)+p*y>>>15)+y*y,g=((E&4294901760)*E|0)+((E&65535)*E|0);c[l]=w^g}u[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,u[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,u[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,u[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,u[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,u[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,u[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,u[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=i._createHelper(x)})(),n.RabbitLegacy})})(It)),It.exports}var Rt={exports:{}},Ba=Rt.exports,Qn;function Aa(){return Qn||(Qn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),r0(),n0(),Ge(),oe())})(Ba,function(n){return(function(){var r=n,o=r.lib,i=o.BlockCipher,s=r.algo;const a=16,f=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var x={pbox:[],sbox:[]};function h(p,y){let w=y>>24&255,g=y>>16&255,v=y>>8&255,b=y&255,C=p.sbox[0][w]+p.sbox[1][g];return C=C^p.sbox[2][v],C=C+p.sbox[3][b],C}function u(p,y,w){let g=y,v=w,b;for(let C=0;C<a;++C)g=g^p.pbox[C],v=h(p,g)^v,b=g,g=v,v=b;return b=g,g=v,v=b,v=v^p.pbox[a],g=g^p.pbox[a+1],{left:g,right:v}}function d(p,y,w){let g=y,v=w,b;for(let C=a+1;C>1;--C)g=g^p.pbox[C],v=h(p,g)^v,b=g,g=v,v=b;return b=g,g=v,v=b,v=v^p.pbox[1],g=g^p.pbox[0],{left:g,right:v}}function l(p,y,w){for(let F=0;F<4;F++){p.sbox[F]=[];for(let _=0;_<256;_++)p.sbox[F][_]=c[F][_]}let g=0;for(let F=0;F<a+2;F++)p.pbox[F]=f[F]^y[g],g++,g>=w&&(g=0);let v=0,b=0,C=0;for(let F=0;F<a+2;F+=2)C=u(p,v,b),v=C.left,b=C.right,p.pbox[F]=v,p.pbox[F+1]=b;for(let F=0;F<4;F++)for(let _=0;_<256;_+=2)C=u(p,v,b),v=C.left,b=C.right,p.sbox[F][_]=v,p.sbox[F][_+1]=b;return!0}var E=s.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var p=this._keyPriorReset=this._key,y=p.words,w=p.sigBytes/4;l(x,y,w)}},encryptBlock:function(p,y){var w=u(x,p[y],p[y+1]);p[y]=w.left,p[y+1]=w.right},decryptBlock:function(p,y){var w=d(x,p[y],p[y+1]);p[y]=w.left,p[y+1]=w.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(E)})(),n.Blowfish})})(Rt)),Rt.exports}var Ca=J0.exports,Jn;function ox(){return Jn||(Jn=1,(function(e,t){(function(n,r,o){e.exports=r(V(),Jt(),bs(),As(),r0(),Ds(),n0(),Po(),Lr(),Hs(),No(),Rs(),Ts(),Os(),Tr(),qs(),Ge(),oe(),Vs(),Gs(),js(),Xs(),Js(),ta(),na(),ia(),aa(),fa(),ua(),da(),pa(),wa(),va(),ba(),Aa())})(Ca,function(n){return n})})(J0)),J0.exports}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ma(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function $0(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >0, got ${e}`)}}function T0(e,t,n=""){const r=ma(e),o=e?.length,i=t!==void 0;if(!r||i&&o!==t){const s=n&&`"${n}" `,a=i?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+a+", got "+f)}return e}function qo(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");$0(e.outputLen),$0(e.blockLen)}function Nt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Da(e,t){T0(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function U0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Lt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const Fa=async()=>{};async function Sa(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);const i=Date.now()-r;i>=0&&i<t||(await Fa(),r+=i)}}function _a(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function eo(e,t=""){return typeof e=="string"?_a(e):T0(e,void 0,t)}function ka(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function Ha(e,t={}){const n=(o,i)=>e(i).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}const $a=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});let Wo=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(qo(t),T0(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),U0(o)}update(t){return Nt(this),this.iHash.update(t),this}digestInto(t){Nt(this),T0(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const zo=(e,t,n)=>new Wo(e,t).update(n).digest();zo.create=(e,t)=>new Wo(e,t);function Ia(e,t,n,r){qo(e);const o=ka({dkLen:32,asyncTick:10},r),{c:i,dkLen:s,asyncTick:a}=o;if($0(i,"c"),$0(s,"dkLen"),$0(a,"asyncTick"),i<1)throw new Error("iterations (c) must be >= 1");const f=eo(t,"password"),c=eo(n,"salt"),x=new Uint8Array(s),h=zo.create(e,f),u=h._cloneInto().update(c);return{c:i,dkLen:s,asyncTick:a,DK:x,PRF:h,PRFSalt:u}}function Ra(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),U0(o),n}async function La(e,t,n,r){const{c:o,dkLen:i,asyncTick:s,DK:a,PRF:f,PRFSalt:c}=Ia(e,t,n,r);let x;const h=new Uint8Array(4),u=Lt(h),d=new Uint8Array(f.outputLen);for(let l=1,E=0;E<i;l++,E+=f.outputLen){const p=a.subarray(E,E+f.outputLen);u.setInt32(0,l,!1),(x=c._cloneInto(x)).update(h).digestInto(d),p.set(d.subarray(0,p.length)),await Sa(o-1,s,()=>{f._cloneInto(x).update(d).digestInto(d);for(let y=0;y<p.length;y++)p[y]^=d[y]})}return Ra(f,c,a,x,d)}let Ta=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Lt(this.buffer)}update(t){Nt(this),T0(t);const{view:n,buffer:r,blockLen:o}=this,i=t.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const f=Lt(t);for(;o<=i-s;s+=o)this.process(f,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Nt(this),Da(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,U0(this.buffer.subarray(s)),this.padOffset>o-s&&(this.process(r,0),s=0);for(let h=s;h<o;h++)n[h]=0;r.setBigUint64(o-8,BigInt(this.length*8),i),this.process(r,0);const a=Lt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const c=f/4,x=this.get();if(c>x.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,x[h],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return t.destroyed=s,t.finished=i,t.length=o,t.pos=a,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};const se=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),V0=BigInt(2**32-1),to=BigInt(32);function Ua(e,t=!1){return t?{h:Number(e&V0),l:Number(e>>to&V0)}:{h:Number(e>>to&V0)|0,l:Number(e&V0)|0}}function Oa(e,t=!1){const n=e.length;let r=new Uint32Array(n),o=new Uint32Array(n);for(let i=0;i<n;i++){const{h:s,l:a}=Ua(e[i],t);[r[i],o[i]]=[s,a]}return[r,o]}const ro=(e,t,n)=>e>>>n,no=(e,t,n)=>e<<32-n|t>>>n,c0=(e,t,n)=>e>>>n|t<<32-n,f0=(e,t,n)=>e<<32-n|t>>>n,M0=(e,t,n)=>e<<64-n|t>>>n-32,G0=(e,t,n)=>e>>>n-32|t<<64-n;function He(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const Pa=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Na=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,qa=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Wa=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,za=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),Ka=(e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,Ko=Oa(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Va=Ko[0],Ma=Ko[1],Ne=new Uint32Array(80),qe=new Uint32Array(80);class Ga extends Ta{constructor(t){super(128,t,16,!1)}get(){const{Ah:t,Al:n,Bh:r,Bl:o,Ch:i,Cl:s,Dh:a,Dl:f,Eh:c,El:x,Fh:h,Fl:u,Gh:d,Gl:l,Hh:E,Hl:p}=this;return[t,n,r,o,i,s,a,f,c,x,h,u,d,l,E,p]}set(t,n,r,o,i,s,a,f,c,x,h,u,d,l,E,p){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=i|0,this.Cl=s|0,this.Dh=a|0,this.Dl=f|0,this.Eh=c|0,this.El=x|0,this.Fh=h|0,this.Fl=u|0,this.Gh=d|0,this.Gl=l|0,this.Hh=E|0,this.Hl=p|0}process(t,n){for(let g=0;g<16;g++,n+=4)Ne[g]=t.getUint32(n),qe[g]=t.getUint32(n+=4);for(let g=16;g<80;g++){const v=Ne[g-15]|0,b=qe[g-15]|0,C=c0(v,b,1)^c0(v,b,8)^ro(v,b,7),F=f0(v,b,1)^f0(v,b,8)^no(v,b,7),_=Ne[g-2]|0,I=qe[g-2]|0,A=c0(_,I,19)^M0(_,I,61)^ro(_,I,6),D=f0(_,I,19)^G0(_,I,61)^no(_,I,6),H=qa(F,D,qe[g-7],qe[g-16]),B=Wa(H,C,A,Ne[g-7],Ne[g-16]);Ne[g]=B|0,qe[g]=H|0}let{Ah:r,Al:o,Bh:i,Bl:s,Ch:a,Cl:f,Dh:c,Dl:x,Eh:h,El:u,Fh:d,Fl:l,Gh:E,Gl:p,Hh:y,Hl:w}=this;for(let g=0;g<80;g++){const v=c0(h,u,14)^c0(h,u,18)^M0(h,u,41),b=f0(h,u,14)^f0(h,u,18)^G0(h,u,41),C=h&d^~h&E,F=u&l^~u&p,_=za(w,b,F,Ma[g],qe[g]),I=Ka(_,y,v,C,Va[g],Ne[g]),A=_|0,D=c0(r,o,28)^M0(r,o,34)^M0(r,o,39),H=f0(r,o,28)^G0(r,o,34)^G0(r,o,39),B=r&i^r&a^i&a,k=o&s^o&f^s&f;y=E|0,w=p|0,E=d|0,p=l|0,d=h|0,l=u|0,{h,l:u}=He(c|0,x|0,I|0,A|0),c=a|0,x=f|0,a=i|0,f=s|0,i=r|0,s=o|0;const S=Pa(A,H,k);r=Na(S,I,D,B),o=S|0}({h:r,l:o}=He(this.Ah|0,this.Al|0,r|0,o|0)),{h:i,l:s}=He(this.Bh|0,this.Bl|0,i|0,s|0),{h:a,l:f}=He(this.Ch|0,this.Cl|0,a|0,f|0),{h:c,l:x}=He(this.Dh|0,this.Dl|0,c|0,x|0),{h,l:u}=He(this.Eh|0,this.El|0,h|0,u|0),{h:d,l}=He(this.Fh|0,this.Fl|0,d|0,l|0),{h:E,l:p}=He(this.Gh|0,this.Gl|0,E|0,p|0),{h:y,l:w}=He(this.Hh|0,this.Hl|0,y|0,w|0),this.set(r,o,i,s,a,f,c,x,h,u,d,l,E,p,y,w)}roundClean(){U0(Ne,qe)}destroy(){U0(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Ya extends Ga{Ah=se[0]|0;Al=se[1]|0;Bh=se[2]|0;Bl=se[3]|0;Ch=se[4]|0;Cl=se[5]|0;Dh=se[6]|0;Dl=se[7]|0;Eh=se[8]|0;El=se[9]|0;Fh=se[10]|0;Fl=se[11]|0;Gh=se[12]|0;Gl=se[13]|0;Hh=se[14]|0;Hl=se[15]|0;constructor(){super(64)}}const ja=Ha(()=>new Ya,$a(3));/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function p0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Za(e){if(!p0(e))throw new Error("Uint8Array expected")}function Vo(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Ur(e){if(typeof e!="function")throw new Error("function expected");return!0}function g0(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function P0(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function qt(e){if(!Array.isArray(e))throw new Error("array expected")}function Mo(e,t){if(!Vo(!0,t))throw new Error(`${e}: array of strings expected`)}function Or(e,t){if(!Vo(!1,t))throw new Error(`${e}: array of numbers expected`)}function er(...e){const t=i=>i,n=(i,s)=>a=>i(s(a)),r=e.map(i=>i.encode).reduceRight(n,t),o=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:o}}function Pr(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Mo("alphabet",t);const r=new Map(t.map((o,i)=>[o,i]));return{encode:o=>(qt(o),o.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:o=>(qt(o),o.map(i=>{g0("alphabet.decode",i);const s=r.get(i);if(s===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return s}))}}function Nr(e=""){return g0("join",e),{encode:t=>(Mo("join.decode",t),t.join(e)),decode:t=>(g0("join.decode",t),t.split(e))}}function Xa(e){return Ur(e),{encode:t=>t,decode:t=>e(t)}}function oo(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(qt(e),!e.length)return[];let r=0;const o=[],i=Array.from(e,a=>{if(P0(a),a<0||a>=t)throw new Error(`invalid integer: ${a}`);return a}),s=i.length;for(;;){let a=0,f=!0;for(let c=r;c<s;c++){const x=i[c],h=t*a,u=h+x;if(!Number.isSafeInteger(u)||h/t!==a||u-x!==h)throw new Error("convertRadix: carry overflow");const d=u/n;a=u%n;const l=Math.floor(d);if(i[c]=l,!Number.isSafeInteger(l)||l*n+a!==u)throw new Error("convertRadix: carry overflow");if(f)l?f=!1:r=c;else continue}if(o.push(a),f)break}for(let a=0;a<e.length-1&&e[a]===0;a++)o.push(0);return o.reverse()}const Go=(e,t)=>t===0?e:Go(t,e%t),Wt=(e,t)=>e+(t-Go(e,t)),Tt=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Ar(e,t,n,r){if(qt(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Wt(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Wt(t,n)}`);let o=0,i=0;const s=Tt[t],a=Tt[n]-1,f=[];for(const c of e){if(P0(c),c>=s)throw new Error(`convertRadix2: invalid data word=${c} from=${t}`);if(o=o<<t|c,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)f.push((o>>i-n&a)>>>0);const x=Tt[i];if(x===void 0)throw new Error("invalid carry");o&=x-1}if(o=o<<n-i&a,!r&&i>=t)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&f.push(o>>>0),f}function Qa(e){P0(e);const t=2**8;return{encode:n=>{if(!p0(n))throw new Error("radix.encode input should be Uint8Array");return oo(Array.from(n),t,e)},decode:n=>(Or("radix.decode",n),Uint8Array.from(oo(n,e,t)))}}function Yo(e,t=!1){if(P0(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Wt(8,e)>32||Wt(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!p0(n))throw new Error("radix2.encode input should be Uint8Array");return Ar(Array.from(n),8,e,!t)},decode:n=>(Or("radix2.decode",n),Uint8Array.from(Ar(n,e,8,t)))}}function io(e){return Ur(e),function(...t){try{return e.apply(null,t)}catch{}}}function Ja(e,t){return P0(e),Ur(t),{encode(n){if(!p0(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!p0(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),o=n.slice(-e),i=t(r).slice(0,e);for(let s=0;s<e;s++)if(i[s]!==o[s])throw new Error("Invalid checksum");return r}}}const ec=e=>er(Qa(58),Pr(e),Nr("")),tc=ec("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),rc=e=>er(Ja(4,t=>e(e(t))),tc),Cr=er(Pr("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Nr("")),so=[996825010,642813549,513874426,1027748829,705979059];function F0(e){const t=e>>25;let n=(e&33554431)<<5;for(let r=0;r<so.length;r++)(t>>r&1)===1&&(n^=so[r]);return n}function ao(e,t,n=1){const r=e.length;let o=1;for(let i=0;i<r;i++){const s=e.charCodeAt(i);if(s<33||s>126)throw new Error(`Invalid prefix (${e})`);o=F0(o)^s>>5}o=F0(o);for(let i=0;i<r;i++)o=F0(o)^e.charCodeAt(i)&31;for(let i of t)o=F0(o)^i;for(let i=0;i<6;i++)o=F0(o);return o^=n,Cr.encode(Ar([o%Tt[30]],30,5,!1))}function jo(e){const t=e==="bech32"?1:734539939,n=Yo(5),r=n.decode,o=n.encode,i=io(r);function s(h,u,d=90){g0("bech32.encode prefix",h),p0(u)&&(u=Array.from(u)),Or("bech32.encode",u);const l=h.length;if(l===0)throw new TypeError(`Invalid prefix length ${l}`);const E=l+7+u.length;if(d!==!1&&E>d)throw new TypeError(`Length ${E} exceeds limit ${d}`);const p=h.toLowerCase(),y=ao(p,u,t);return`${p}1${Cr.encode(u)}${y}`}function a(h,u=90){g0("bech32.decode input",h);const d=h.length;if(d<8||u!==!1&&d>u)throw new TypeError(`invalid string length: ${d} (${h}). Expected (8..${u})`);const l=h.toLowerCase();if(h!==l&&h!==h.toUpperCase())throw new Error("String must be lowercase or uppercase");const E=l.lastIndexOf("1");if(E===0||E===-1)throw new Error('Letter "1" must be present between prefix and data only');const p=l.slice(0,E),y=l.slice(E+1);if(y.length<6)throw new Error("Data must be at least 6 characters long");const w=Cr.decode(y).slice(0,-6),g=ao(p,w,t);if(!y.endsWith(g))throw new Error(`Invalid checksum in ${h}: expected "${g}"`);return{prefix:p,words:w}}const f=io(a);function c(h){const{prefix:u,words:d}=a(h,!1);return{prefix:u,words:d,bytes:r(d)}}function x(h,u){return s(h,o(u))}return{encode:s,decode:a,encodeFromBytes:x,decodeToBytes:c,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:i,toWords:o}}const mr=jo("bech32"),Zo=jo("bech32m"),nc={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},oc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",ic={encode(e){return Za(e),e.toHex()},decode(e){return g0("hex",e),Uint8Array.fromHex(e)}},Q=oc?ic:er(Yo(4),Pr("0123456789abcdef"),Nr(""),Xa(e=>{if(typeof e!="string"||e.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */function Xo(e){if(typeof e!="string")throw new TypeError("invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function sc(e){const t=Xo(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}const ac=e=>Xo("mnemonic"+e);function ax(e,t=""){return La(ja,sc(e).nfkd,ac(t),{c:2048,dkLen:64})}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function qr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function e0(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >0, got ${e}`)}}function j(e,t,n=""){const r=qr(e),o=e?.length,i=t!==void 0;if(!r||i&&o!==t){const s=n&&`"${n}" `,a=i?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+a+", got "+f)}return e}function Qo(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");e0(e.outputLen),e0(e.blockLen)}function zt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function cc(e,t){j(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function w0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function dr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Se(e,t){return e<<32-t|e>>>t}function Y0(e,t){return e<<t|e>>>32-t>>>0}const Jo=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",fc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tr(e){if(j(e),Jo)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=fc[e[n]];return t}const $e={_0:48,_9:57,A:65,F:70,a:97,f:102};function co(e){if(e>=$e._0&&e<=$e._9)return e-$e._0;if(e>=$e.A&&e<=$e.F)return e-($e.A-10);if(e>=$e.a&&e<=$e.f)return e-($e.a-10)}function Kt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Jo)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){const s=co(e.charCodeAt(i)),a=co(e.charCodeAt(i+1));if(s===void 0||a===void 0){const f=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+i)}r[o]=s*16+a}return r}function _e(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];j(o),t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const i=e[r];n.set(i,o),o+=i.length}return n}function ei(e,t={}){const n=(o,i)=>e(i).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}function rr(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}const xc=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function uc(e,t,n){return e&t^~e&n}function hc(e,t,n){return e&t^e&n^t&n}class ti{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=dr(this.buffer)}update(t){zt(this),j(t);const{view:n,buffer:r,blockLen:o}=this,i=t.length;for(let s=0;s<i;){const a=Math.min(o-this.pos,i-s);if(a===o){const f=dr(t);for(;o<=i-s;s+=o)this.process(f,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){zt(this),cc(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,w0(this.buffer.subarray(s)),this.padOffset>o-s&&(this.process(r,0),s=0);for(let h=s;h<o;h++)n[h]=0;r.setBigUint64(o-8,BigInt(this.length*8),i),this.process(r,0);const a=dr(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const c=f/4,x=this.get();if(c>x.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<c;h++)a.setUint32(4*h,x[h],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:a}=this;return t.destroyed=s,t.finished=i,t.length=o,t.pos=a,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const We=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),dc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ze=new Uint32Array(64);class lc extends ti{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:n,C:r,D:o,E:i,F:s,G:a,H:f}=this;return[t,n,r,o,i,s,a,f]}set(t,n,r,o,i,s,a,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=f|0}process(t,n){for(let h=0;h<16;h++,n+=4)ze[h]=t.getUint32(n,!1);for(let h=16;h<64;h++){const u=ze[h-15],d=ze[h-2],l=Se(u,7)^Se(u,18)^u>>>3,E=Se(d,17)^Se(d,19)^d>>>10;ze[h]=E+ze[h-7]+l+ze[h-16]|0}let{A:r,B:o,C:i,D:s,E:a,F:f,G:c,H:x}=this;for(let h=0;h<64;h++){const u=Se(a,6)^Se(a,11)^Se(a,25),d=x+u+uc(a,f,c)+dc[h]+ze[h]|0,E=(Se(r,2)^Se(r,13)^Se(r,22))+hc(r,o,i)|0;x=c,c=f,f=a,a=s+d|0,s=i,i=o,o=r,r=d+E|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,f=f+this.F|0,c=c+this.G|0,x=x+this.H|0,this.set(r,o,i,s,a,f,c,x)}roundClean(){w0(ze)}destroy(){this.set(0,0,0,0,0,0,0,0),w0(this.buffer)}}class pc extends lc{A=We[0]|0;B=We[1]|0;C=We[2]|0;D=We[3]|0;E=We[4]|0;F=We[5]|0;G=We[6]|0;H=We[7]|0;constructor(){super(32)}}const ue=ei(()=>new pc,xc(1));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wr=BigInt(0),Dr=BigInt(1);function Vt(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}" `;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function ri(e){if(typeof e=="bigint"){if(!Ut(e))throw new Error("positive bigint expected, got "+e)}else e0(e);return e}function j0(e){const t=ri(e).toString(16);return t.length&1?"0"+t:t}function ni(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Wr:BigInt("0x"+e)}function Le(e){return ni(tr(e))}function oi(e){return ni(tr(gc(j(e)).reverse()))}function nr(e,t){e0(t),e=ri(e);const n=Kt(e.toString(16).padStart(t*2,"0"));if(n.length!==t)throw new Error("number too large");return n}function ii(e,t){return nr(e,t).reverse()}function gc(e){return Uint8Array.from(e)}function wc(e){return Uint8Array.from(e,(t,n)=>{const r=t.charCodeAt(0);if(t.length!==1||r>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${r} at position ${n}`);return r})}const Ut=e=>typeof e=="bigint"&&Wr<=e;function Ec(e,t,n){return Ut(e)&&Ut(t)&&Ut(n)&&t<=e&&e<n}function vc(e,t,n,r){if(!Ec(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function yc(e){let t;for(t=0;e>Wr;e>>=Dr,t+=1);return t}const zr=e=>(Dr<<BigInt(e))-Dr;function bc(e,t,n){if(e0(e,"hashLen"),e0(t,"qByteLen"),typeof n!="function")throw new Error("hmacFn must be a function");const r=p=>new Uint8Array(p),o=Uint8Array.of(),i=Uint8Array.of(0),s=Uint8Array.of(1),a=1e3;let f=r(e),c=r(e),x=0;const h=()=>{f.fill(1),c.fill(0),x=0},u=(...p)=>n(c,_e(f,...p)),d=(p=o)=>{c=u(i,p),f=u(),p.length!==0&&(c=u(s,p),f=u())},l=()=>{if(x++>=a)throw new Error("drbg: tried max amount of iterations");let p=0;const y=[];for(;p<t;){f=u();const w=f.slice();y.push(w),p+=f.length}return _e(...y)};return(p,y)=>{h(),d(p);let w;for(;!(w=y(l()));)d();return h(),w}}function Kr(e,t={},n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(i,s,a){const f=e[i];if(a&&f===void 0)return;const c=typeof f;if(c!==s||f===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${c}`)}const o=(i,s)=>Object.entries(i).forEach(([a,f])=>r(a,f,s));o(t,!1),o(n,!0)}function fo(e){const t=new WeakMap;return(n,...r)=>{const o=t.get(n);if(o!==void 0)return o;const i=e(n,...r);return t.set(n,i),i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const de=BigInt(0),fe=BigInt(1),Xe=BigInt(2),si=BigInt(3),ai=BigInt(4),ci=BigInt(5),Bc=BigInt(7),fi=BigInt(8),Ac=BigInt(9),xi=BigInt(16);function Ce(e,t){const n=e%t;return n>=de?n:t+n}function be(e,t,n){let r=e;for(;t-- >de;)r*=r,r%=n;return r}function xo(e,t){if(e===de)throw new Error("invert: expected non-zero number");if(t<=de)throw new Error("invert: expected positive modulus, got "+t);let n=Ce(e,t),r=t,o=de,i=fe;for(;n!==de;){const a=r/n,f=r%n,c=o-i*a;r=n,n=f,o=i,i=c}if(r!==fe)throw new Error("invert: does not exist");return Ce(o,t)}function Vr(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function ui(e,t){const n=(e.ORDER+fe)/ai,r=e.pow(t,n);return Vr(e,r,t),r}function Cc(e,t){const n=(e.ORDER-ci)/fi,r=e.mul(t,Xe),o=e.pow(r,n),i=e.mul(t,o),s=e.mul(e.mul(i,Xe),o),a=e.mul(i,e.sub(s,e.ONE));return Vr(e,a,t),a}function mc(e){const t=or(e),n=hi(e),r=n(t,t.neg(t.ONE)),o=n(t,r),i=n(t,t.neg(r)),s=(e+Bc)/xi;return(a,f)=>{let c=a.pow(f,s),x=a.mul(c,r);const h=a.mul(c,o),u=a.mul(c,i),d=a.eql(a.sqr(x),f),l=a.eql(a.sqr(h),f);c=a.cmov(c,x,d),x=a.cmov(u,h,l);const E=a.eql(a.sqr(x),f),p=a.cmov(c,x,E);return Vr(a,p,f),p}}function hi(e){if(e<si)throw new Error("sqrt is not defined for small field");let t=e-fe,n=0;for(;t%Xe===de;)t/=Xe,n++;let r=Xe;const o=or(e);for(;uo(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return ui;let i=o.pow(r,t);const s=(t+fe)/Xe;return function(f,c){if(f.is0(c))return c;if(uo(f,c)!==1)throw new Error("Cannot find square root");let x=n,h=f.mul(f.ONE,i),u=f.pow(c,t),d=f.pow(c,s);for(;!f.eql(u,f.ONE);){if(f.is0(u))return f.ZERO;let l=1,E=f.sqr(u);for(;!f.eql(E,f.ONE);)if(l++,E=f.sqr(E),l===x)throw new Error("Cannot find square root");const p=fe<<BigInt(x-l-1),y=f.pow(h,p);x=l,h=f.sqr(y),u=f.mul(u,h),d=f.mul(d,y)}return d}}function Dc(e){return e%ai===si?ui:e%fi===ci?Cc:e%xi===Ac?mc(e):hi(e)}const Fc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Sc(e){const t={ORDER:"bigint",BYTES:"number",BITS:"number"},n=Fc.reduce((r,o)=>(r[o]="function",r),t);return Kr(e,n),e}function _c(e,t,n){if(n<de)throw new Error("invalid exponent, negatives unsupported");if(n===de)return e.ONE;if(n===fe)return t;let r=e.ONE,o=t;for(;n>de;)n&fe&&(r=e.mul(r,o)),o=e.sqr(o),n>>=fe;return r}function di(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((s,a,f)=>e.is0(a)?s:(r[f]=s,e.mul(s,a)),e.ONE),i=e.inv(o);return t.reduceRight((s,a,f)=>e.is0(a)?s:(r[f]=e.mul(s,r[f]),e.mul(s,a)),i),r}function uo(e,t){const n=(e.ORDER-fe)/Xe,r=e.pow(t,n),o=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!o&&!i&&!s)throw new Error("invalid Legendre symbol result");return o?1:i?0:-1}function kc(e,t){t!==void 0&&e0(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}class Hc{ORDER;BITS;BYTES;isLE;ZERO=de;ONE=fe;_lengths;_sqrt;_mod;constructor(t,n={}){if(t<=de)throw new Error("invalid field: expected ORDER > 0, got "+t);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=n.allowedLengths?.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));const{nBitLength:o,nByteLength:i}=kc(t,r);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=i,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return Ce(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return de<=t&&t<this.ORDER}is0(t){return t===de}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&fe)===fe}neg(t){return Ce(-t,this.ORDER)}eql(t,n){return t===n}sqr(t){return Ce(t*t,this.ORDER)}add(t,n){return Ce(t+n,this.ORDER)}sub(t,n){return Ce(t-n,this.ORDER)}mul(t,n){return Ce(t*n,this.ORDER)}pow(t,n){return _c(this,t,n)}div(t,n){return Ce(t*xo(n,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,n){return t+n}subN(t,n){return t-n}mulN(t,n){return t*n}inv(t){return xo(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=Dc(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?ii(t,this.BYTES):nr(t,this.BYTES)}fromBytes(t,n=!1){j(t);const{_lengths:r,BYTES:o,isLE:i,ORDER:s,_mod:a}=this;if(r){if(!r.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+t.length);const c=new Uint8Array(o);c.set(t,i?0:c.length-t.length),t=c}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let f=i?oi(t):Le(t);if(a&&(f=Ce(f,s)),!n&&!this.isValid(f))throw new Error("invalid field element: outside of range 0..ORDER");return f}invertBatch(t){return di(this,t)}cmov(t,n,r){return r?n:t}}function or(e,t={}){return new Hc(e,t)}function li(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function pi(e){const t=li(e);return t+Math.ceil(t/2)}function gi(e,t,n=!1){j(e);const r=e.length,o=li(t),i=pi(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const s=n?oi(e):Le(e),a=Ce(s,t-fe)+fe;return n?ii(a,o):nr(a,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const E0=BigInt(0),Qe=BigInt(1);function Mt(e,t){const n=t.negate();return e?n:t}function ho(e,t){const n=di(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function wi(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function lr(e,t){wi(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,i=zr(e),s=BigInt(e);return{windows:n,windowSize:r,mask:i,maxNumber:o,shiftBy:s}}function lo(e,t,n){const{windowSize:r,mask:o,maxNumber:i,shiftBy:s}=n;let a=Number(e&o),f=e>>s;a>r&&(a-=i,f+=Qe);const c=t*r,x=c+Math.abs(a)-1,h=a===0,u=a<0,d=t%2!==0;return{nextN:f,offset:x,isZero:h,isNeg:u,isNegF:d,offsetF:c}}const pr=new WeakMap,Ei=new WeakMap;function gr(e){return Ei.get(e)||1}function po(e){if(e!==E0)throw new Error("invalid wNAF")}class $c{BASE;ZERO;Fn;bits;constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>E0;)n&Qe&&(r=r.add(o)),o=o.double(),n>>=Qe;return r}precomputeWindow(t,n){const{windows:r,windowSize:o}=lr(n,this.bits),i=[];let s=t,a=s;for(let f=0;f<r;f++){a=s,i.push(a);for(let c=1;c<o;c++)a=a.add(s),i.push(a);s=a.double()}return i}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,i=this.BASE;const s=lr(t,this.bits);for(let a=0;a<s.windows;a++){const{nextN:f,offset:c,isZero:x,isNeg:h,isNegF:u,offsetF:d}=lo(r,a,s);r=f,x?i=i.add(Mt(u,n[d])):o=o.add(Mt(h,n[c]))}return po(r),{p:o,f:i}}wNAFUnsafe(t,n,r,o=this.ZERO){const i=lr(t,this.bits);for(let s=0;s<i.windows&&r!==E0;s++){const{nextN:a,offset:f,isZero:c,isNeg:x}=lo(r,s,i);if(r=a,!c){const h=n[f];o=o.add(x?h.negate():h)}}return po(r),o}getPrecomputes(t,n,r){let o=pr.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),pr.set(n,o))),o}cached(t,n,r){const o=gr(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){const i=gr(t);return i===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),n,o)}createCache(t,n){wi(n,this.bits),Ei.set(t,n),pr.delete(t)}hasCache(t){return gr(t)!==1}}function Ic(e,t,n,r){let o=t,i=e.ZERO,s=e.ZERO;for(;n>E0||r>E0;)n&Qe&&(i=i.add(o)),r&Qe&&(s=s.add(o)),o=o.double(),n>>=Qe,r>>=Qe;return{p1:i,p2:s}}function go(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Sc(t),t}else return or(e,{isLE:n})}function Rc(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const c=t[f];if(!(typeof c=="bigint"&&c>E0))throw new Error(`CURVE.${f} must be positive bigint`)}const o=go(t.p,n.Fp,r),i=go(t.n,n.Fn,r),a=["Gx","Gy","a","b"];for(const f of a)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:i}}function vi(e,t){return function(r){const o=e(r);return{secretKey:o,publicKey:t(o)}}}class yi{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(Qo(t),j(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),w0(o)}update(t){return zt(this),this.iHash.update(t),this}digestInto(t){zt(this),j(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bi=(e,t,n)=>new yi(e,t).update(n).digest();bi.create=(e,t)=>new yi(e,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wo=(e,t)=>(e+(e>=0?t:-t)/Bi)/t;function Lc(e,t,n){const[[r,o],[i,s]]=t,a=wo(s*e,n),f=wo(-o*e,n);let c=e-a*r-f*i,x=-a*o-f*s;const h=c<Ie,u=x<Ie;h&&(c=-c),u&&(x=-x);const d=zr(Math.ceil(yc(n)/2))+d0;if(c<Ie||c>=d||x<Ie||x>=d)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:h,k1:c,k2neg:u,k2:x}}function Fr(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function wr(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return Vt(n.lowS,"lowS"),Vt(n.prehash,"prehash"),n.format!==void 0&&Fr(n.format),n}class Tc extends Error{constructor(t=""){super(t)}}const Ve={Err:Tc,_tlv:{encode:(e,t)=>{const{Err:n}=Ve;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,o=j0(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?j0(o.length/2|128):"";return j0(e)+i+o+t},decode(e,t){const{Err:n}=Ve;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const o=t[r++],i=!!(o&128);let s=0;if(!i)s=o;else{const f=o&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const c=t.subarray(r,r+f);if(c.length!==f)throw new n("tlv.decode: length bytes not complete");if(c[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const x of c)s=s<<8|x;if(r+=f,s<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+s);if(a.length!==s)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+s)}}},_int:{encode(e){const{Err:t}=Ve;if(e<Ie)throw new t("integer: negative integers are not allowed");let n=j0(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Ve;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Le(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Ve,o=j(e,void 0,"signature"),{v:i,l:s}=r.decode(48,o);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:f}=r.decode(2,i),{v:c,l:x}=r.decode(2,f);if(x.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=Ve,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),i=r+o;return t.encode(48,i)}},Ie=BigInt(0),d0=BigInt(1),Bi=BigInt(2),Z0=BigInt(3),Uc=BigInt(4);function Oc(e,t={}){const n=Rc("weierstrass",e,t),{Fp:r,Fn:o}=n;let i=n.CURVE;const{h:s,n:a}=i;Kr(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});const{endo:f}=t;if(f&&(!r.is0(i.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const c=Ci(r,o);function x(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function h(H,B,k){const{x:S,y:T}=B.toAffine(),P=r.toBytes(S);if(Vt(k,"isCompressed"),k){x();const O=!r.isOdd(T);return _e(Ai(O),P)}else return _e(Uint8Array.of(4),P,r.toBytes(T))}function u(H){j(H,void 0,"Point");const{publicKey:B,publicKeyUncompressed:k}=c,S=H.length,T=H[0],P=H.subarray(1);if(S===B&&(T===2||T===3)){const O=r.fromBytes(P);if(!r.isValid(O))throw new Error("bad point: is not on curve, wrong x");const N=E(O);let U;try{U=r.sqrt(N)}catch(L){const R=L instanceof Error?": "+L.message:"";throw new Error("bad point: is not on curve, sqrt error"+R)}x();const m=r.isOdd(U);return(T&1)===1!==m&&(U=r.neg(U)),{x:O,y:U}}else if(S===k&&T===4){const O=r.BYTES,N=r.fromBytes(P.subarray(0,O)),U=r.fromBytes(P.subarray(O,O*2));if(!p(N,U))throw new Error("bad point: is not on curve");return{x:N,y:U}}else throw new Error(`bad point: got length ${S}, expected compressed=${B} or uncompressed=${k}`)}const d=t.toBytes||h,l=t.fromBytes||u;function E(H){const B=r.sqr(H),k=r.mul(B,H);return r.add(r.add(k,r.mul(H,i.a)),i.b)}function p(H,B){const k=r.sqr(B),S=E(H);return r.eql(k,S)}if(!p(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const y=r.mul(r.pow(i.a,Z0),Uc),w=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(y,w)))throw new Error("bad curve params: a or b");function g(H,B,k=!1){if(!r.isValid(B)||k&&r.is0(B))throw new Error(`bad point coordinate ${H}`);return B}function v(H){if(!(H instanceof I))throw new Error("Weierstrass Point expected")}function b(H){if(!f||!f.basises)throw new Error("no endo");return Lc(H,f.basises,o.ORDER)}const C=fo((H,B)=>{const{X:k,Y:S,Z:T}=H;if(r.eql(T,r.ONE))return{x:k,y:S};const P=H.is0();B==null&&(B=P?r.ONE:r.inv(T));const O=r.mul(k,B),N=r.mul(S,B),U=r.mul(T,B);if(P)return{x:r.ZERO,y:r.ZERO};if(!r.eql(U,r.ONE))throw new Error("invZ was invalid");return{x:O,y:N}}),F=fo(H=>{if(H.is0()){if(t.allowInfinityPoint&&!r.is0(H.Y))return;throw new Error("bad point: ZERO")}const{x:B,y:k}=H.toAffine();if(!r.isValid(B)||!r.isValid(k))throw new Error("bad point: x or y not field elements");if(!p(B,k))throw new Error("bad point: equation left != right");if(!H.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function _(H,B,k,S,T){return k=new I(r.mul(k.X,H),k.Y,k.Z),B=Mt(S,B),k=Mt(T,k),B.add(k)}class I{static BASE=new I(i.Gx,i.Gy,r.ONE);static ZERO=new I(r.ZERO,r.ONE,r.ZERO);static Fp=r;static Fn=o;X;Y;Z;constructor(B,k,S){this.X=g("x",B),this.Y=g("y",k,!0),this.Z=g("z",S),Object.freeze(this)}static CURVE(){return i}static fromAffine(B){const{x:k,y:S}=B||{};if(!B||!r.isValid(k)||!r.isValid(S))throw new Error("invalid affine point");if(B instanceof I)throw new Error("projective point not allowed");return r.is0(k)&&r.is0(S)?I.ZERO:new I(k,S,r.ONE)}static fromBytes(B){const k=I.fromAffine(l(j(B,void 0,"point")));return k.assertValidity(),k}static fromHex(B){return I.fromBytes(Kt(B))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(B=8,k=!0){return D.createCache(this,B),k||this.multiply(Z0),this}assertValidity(){F(this)}hasEvenY(){const{y:B}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(B)}equals(B){v(B);const{X:k,Y:S,Z:T}=this,{X:P,Y:O,Z:N}=B,U=r.eql(r.mul(k,N),r.mul(P,T)),m=r.eql(r.mul(S,N),r.mul(O,T));return U&&m}negate(){return new I(this.X,r.neg(this.Y),this.Z)}double(){const{a:B,b:k}=i,S=r.mul(k,Z0),{X:T,Y:P,Z:O}=this;let N=r.ZERO,U=r.ZERO,m=r.ZERO,$=r.mul(T,T),L=r.mul(P,P),R=r.mul(O,O),q=r.mul(T,P);return q=r.add(q,q),m=r.mul(T,O),m=r.add(m,m),N=r.mul(B,m),U=r.mul(S,R),U=r.add(N,U),N=r.sub(L,U),U=r.add(L,U),U=r.mul(N,U),N=r.mul(q,N),m=r.mul(S,m),R=r.mul(B,R),q=r.sub($,R),q=r.mul(B,q),q=r.add(q,m),m=r.add($,$),$=r.add(m,$),$=r.add($,R),$=r.mul($,q),U=r.add(U,$),R=r.mul(P,O),R=r.add(R,R),$=r.mul(R,q),N=r.sub(N,$),m=r.mul(R,L),m=r.add(m,m),m=r.add(m,m),new I(N,U,m)}add(B){v(B);const{X:k,Y:S,Z:T}=this,{X:P,Y:O,Z:N}=B;let U=r.ZERO,m=r.ZERO,$=r.ZERO;const L=i.a,R=r.mul(i.b,Z0);let q=r.mul(k,P),W=r.mul(S,O),M=r.mul(T,N),z=r.add(k,S),G=r.add(P,O);z=r.mul(z,G),G=r.add(q,W),z=r.sub(z,G),G=r.add(k,T);let X=r.add(P,N);return G=r.mul(G,X),X=r.add(q,M),G=r.sub(G,X),X=r.add(S,T),U=r.add(O,N),X=r.mul(X,U),U=r.add(W,M),X=r.sub(X,U),$=r.mul(L,G),U=r.mul(R,M),$=r.add(U,$),U=r.sub(W,$),$=r.add(W,$),m=r.mul(U,$),W=r.add(q,q),W=r.add(W,q),M=r.mul(L,M),G=r.mul(R,G),W=r.add(W,M),M=r.sub(q,M),M=r.mul(L,M),G=r.add(G,M),q=r.mul(W,G),m=r.add(m,q),q=r.mul(X,G),U=r.mul(z,U),U=r.sub(U,q),q=r.mul(z,W),$=r.mul(X,$),$=r.add($,q),new I(U,m,$)}subtract(B){return this.add(B.negate())}is0(){return this.equals(I.ZERO)}multiply(B){const{endo:k}=t;if(!o.isValidNot0(B))throw new Error("invalid scalar: out of range");let S,T;const P=O=>D.cached(this,O,N=>ho(I,N));if(k){const{k1neg:O,k1:N,k2neg:U,k2:m}=b(B),{p:$,f:L}=P(N),{p:R,f:q}=P(m);T=L.add(q),S=_(k.beta,$,R,O,U)}else{const{p:O,f:N}=P(B);S=O,T=N}return ho(I,[S,T])[0]}multiplyUnsafe(B){const{endo:k}=t,S=this;if(!o.isValid(B))throw new Error("invalid scalar: out of range");if(B===Ie||S.is0())return I.ZERO;if(B===d0)return S;if(D.hasCache(this))return this.multiply(B);if(k){const{k1neg:T,k1:P,k2neg:O,k2:N}=b(B),{p1:U,p2:m}=Ic(I,S,P,N);return _(k.beta,U,m,T,O)}else return D.unsafe(S,B)}toAffine(B){return C(this,B)}isTorsionFree(){const{isTorsionFree:B}=t;return s===d0?!0:B?B(I,this):D.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:B}=t;return s===d0?this:B?B(I,this):this.multiplyUnsafe(s)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}toBytes(B=!0){return Vt(B,"isCompressed"),this.assertValidity(),d(I,this,B)}toHex(B=!0){return tr(this.toBytes(B))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const A=o.BITS,D=new $c(I,t.endo?Math.ceil(A/2):A);return I.BASE.precompute(8),I}function Ai(e){return Uint8Array.of(e?2:3)}function Ci(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Pc(e,t={}){const{Fn:n}=e,r=t.randomBytes||rr,o=Object.assign(Ci(e.Fp,n),{seed:pi(n.ORDER)});function i(d){try{const l=n.fromBytes(d);return n.isValidNot0(l)}catch{return!1}}function s(d,l){const{publicKey:E,publicKeyUncompressed:p}=o;try{const y=d.length;return l===!0&&y!==E||l===!1&&y!==p?!1:!!e.fromBytes(d)}catch{return!1}}function a(d=r(o.seed)){return gi(j(d,o.seed,"seed"),n.ORDER)}function f(d,l=!0){return e.BASE.multiply(n.fromBytes(d)).toBytes(l)}function c(d){const{secretKey:l,publicKey:E,publicKeyUncompressed:p}=o;if(!qr(d)||"_lengths"in n&&n._lengths||l===E)return;const y=j(d,void 0,"key").length;return y===E||y===p}function x(d,l,E=!0){if(c(d)===!0)throw new Error("first arg must be private key");if(c(l)===!1)throw new Error("second arg must be public key");const p=n.fromBytes(d);return e.fromBytes(l).multiply(p).toBytes(E)}const h={isValidSecretKey:i,isValidPublicKey:s,randomSecretKey:a},u=vi(a,f);return Object.freeze({getPublicKey:f,getSharedSecret:x,keygen:u,Point:e,utils:h,lengths:o})}function Nc(e,t,n={}){Qo(t),Kr(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),n=Object.assign({},n);const r=n.randomBytes||rr,o=n.hmac||((k,S)=>bi(t,k,S)),{Fp:i,Fn:s}=e,{ORDER:a,BITS:f}=s,{keygen:c,getPublicKey:x,getSharedSecret:h,utils:u,lengths:d}=Pc(e,n),l={prehash:!0,lowS:typeof n.lowS=="boolean"?n.lowS:!0,format:"compact",extraEntropy:!1},E=a*Bi<i.ORDER;function p(k){const S=a>>d0;return k>S}function y(k,S){if(!s.isValidNot0(S))throw new Error(`invalid signature ${k}: out of range 1..Point.Fn.ORDER`);return S}function w(){if(E)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function g(k,S){Fr(S);const T=d.signature,P=S==="compact"?T:S==="recovered"?T+1:void 0;return j(k,P)}class v{r;s;recovery;constructor(S,T,P){if(this.r=y("r",S),this.s=y("s",T),P!=null){if(w(),![0,1,2,3].includes(P))throw new Error("invalid recovery id");this.recovery=P}Object.freeze(this)}static fromBytes(S,T=l.format){g(S,T);let P;if(T==="der"){const{r:m,s:$}=Ve.toSig(j(S));return new v(m,$)}T==="recovered"&&(P=S[0],T="compact",S=S.subarray(1));const O=d.signature/2,N=S.subarray(0,O),U=S.subarray(O,O*2);return new v(s.fromBytes(N),s.fromBytes(U),P)}static fromHex(S,T){return this.fromBytes(Kt(S),T)}assertRecovery(){const{recovery:S}=this;if(S==null)throw new Error("invalid recovery id: must be present");return S}addRecoveryBit(S){return new v(this.r,this.s,S)}recoverPublicKey(S){const{r:T,s:P}=this,O=this.assertRecovery(),N=O===2||O===3?T+a:T;if(!i.isValid(N))throw new Error("invalid recovery id: sig.r+curve.n != R.x");const U=i.toBytes(N),m=e.fromBytes(_e(Ai((O&1)===0),U)),$=s.inv(N),L=C(j(S,void 0,"msgHash")),R=s.create(-L*$),q=s.create(P*$),W=e.BASE.multiplyUnsafe(R).add(m.multiplyUnsafe(q));if(W.is0())throw new Error("invalid recovery: point at infinify");return W.assertValidity(),W}hasHighS(){return p(this.s)}toBytes(S=l.format){if(Fr(S),S==="der")return Kt(Ve.hexFromSig(this));const{r:T,s:P}=this,O=s.toBytes(T),N=s.toBytes(P);return S==="recovered"?(w(),_e(Uint8Array.of(this.assertRecovery()),O,N)):_e(O,N)}toHex(S){return tr(this.toBytes(S))}}const b=n.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");const T=Le(S),P=S.length*8-f;return P>0?T>>BigInt(P):T},C=n.bits2int_modN||function(S){return s.create(b(S))},F=zr(f);function _(k){return vc("num < 2^"+f,k,Ie,F),s.toBytes(k)}function I(k,S){return j(k,void 0,"message"),S?j(t(k),void 0,"prehashed message"):k}function A(k,S,T){const{lowS:P,prehash:O,extraEntropy:N}=wr(T,l);k=I(k,O);const U=C(k),m=s.fromBytes(S);if(!s.isValidNot0(m))throw new Error("invalid private key");const $=[_(m),_(U)];if(N!=null&&N!==!1){const W=N===!0?r(d.secretKey):N;$.push(j(W,void 0,"extraEntropy"))}const L=_e(...$),R=U;function q(W){const M=b(W);if(!s.isValidNot0(M))return;const z=s.inv(M),G=e.BASE.multiply(M).toAffine(),X=s.create(G.x);if(X===Ie)return;const Te=s.create(z*s.create(R+X*m));if(Te===Ie)return;let Ue=(G.x===X?0:2)|Number(G.y&d0),xe=Te;return P&&p(Te)&&(xe=s.neg(Te),Ue^=1),new v(X,xe,E?void 0:Ue)}return{seed:L,k2sig:q}}function D(k,S,T={}){const{seed:P,k2sig:O}=A(k,S,T);return bc(t.outputLen,s.BYTES,o)(P,O).toBytes(T.format)}function H(k,S,T,P={}){const{lowS:O,prehash:N,format:U}=wr(P,l);if(T=j(T,void 0,"publicKey"),S=I(S,N),!qr(k)){const m=k instanceof v?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+m)}g(k,U);try{const m=v.fromBytes(k,U),$=e.fromBytes(T);if(O&&m.hasHighS())return!1;const{r:L,s:R}=m,q=C(S),W=s.inv(R),M=s.create(q*W),z=s.create(L*W),G=e.BASE.multiplyUnsafe(M).add($.multiplyUnsafe(z));return G.is0()?!1:s.create(G.x)===L}catch{return!1}}function B(k,S,T={}){const{prehash:P}=wr(T,l);return S=I(S,P),v.fromBytes(k,"recovered").recoverPublicKey(S).toBytes()}return Object.freeze({keygen:c,getPublicKey:x,getSharedSecret:h,utils:u,lengths:d,Point:e,sign:D,verify:H,recoverPublicKey:B,Signature:v,hash:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ir={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},qc={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Wc=BigInt(0),Sr=BigInt(2);function zc(e){const t=ir.p,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),f=BigInt(88),c=e*e*e%t,x=c*c*e%t,h=be(x,n,t)*x%t,u=be(h,n,t)*x%t,d=be(u,Sr,t)*c%t,l=be(d,o,t)*d%t,E=be(l,i,t)*l%t,p=be(E,a,t)*E%t,y=be(p,f,t)*p%t,w=be(y,a,t)*E%t,g=be(w,n,t)*x%t,v=be(g,s,t)*l%t,b=be(v,r,t)*c%t,C=be(b,Sr,t);if(!Gt.eql(Gt.sqr(C),e))throw new Error("Cannot find square root");return C}const Gt=or(ir.p,{sqrt:zc}),o0=Oc(ir,{Fp:Gt,endo:qc}),x0=Nc(o0,ue),Eo={};function Yt(e,...t){let n=Eo[e];if(n===void 0){const r=ue(wc(e));n=_e(r,r),Eo[e]=n}return ue(_e(n,...t))}const Mr=e=>e.toBytes(!0).slice(1),Gr=e=>e%Sr===Wc;function _r(e){const{Fn:t,BASE:n}=o0,r=t.fromBytes(e),o=n.multiply(r);return{scalar:Gr(o.y)?r:t.neg(r),bytes:Mr(o)}}function mi(e){const t=Gt;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x ≥ p");const n=t.create(e*e),r=t.create(n*e+BigInt(7));let o=t.sqrt(r);Gr(o)||(o=t.neg(o));const i=o0.fromAffine({x:e,y:o});return i.assertValidity(),i}const I0=Le;function Di(...e){return o0.Fn.create(I0(Yt("BIP0340/challenge",...e)))}function vo(e){return _r(e).bytes}function Kc(e,t,n=rr(32)){const{Fn:r}=o0,o=j(e,void 0,"message"),{bytes:i,scalar:s}=_r(t),a=j(n,32,"auxRand"),f=r.toBytes(s^I0(Yt("BIP0340/aux",a))),c=Yt("BIP0340/nonce",f,i,o),{bytes:x,scalar:h}=_r(c),u=Di(x,i,o),d=new Uint8Array(64);if(d.set(x,0),d.set(r.toBytes(r.create(h+u*s)),32),!Fi(d,o,i))throw new Error("sign: Invalid signature produced");return d}function Fi(e,t,n){const{Fp:r,Fn:o,BASE:i}=o0,s=j(e,64,"signature"),a=j(t,void 0,"message"),f=j(n,32,"publicKey");try{const c=mi(I0(f)),x=I0(s.subarray(0,32));if(!r.isValidNot0(x))return!1;const h=I0(s.subarray(32,64));if(!o.isValidNot0(h))return!1;const u=Di(o.toBytes(x),Mr(c),a),d=i.multiplyUnsafe(h).add(c.multiplyUnsafe(o.neg(u))),{x:l,y:E}=d.toAffine();return!(d.is0()||!Gr(E)||l!==x)}catch{return!1}}const i0=(()=>{const n=(r=rr(48))=>gi(r,ir.n);return{keygen:vi(n,vo),getPublicKey:vo,sign:Kc,verify:Fi,Point:o0,utils:{randomSecretKey:n,taggedHash:Yt,lift_x:mi,pointToBytes:Mr},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),Vc=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Si=Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)),Mc=Si.map(e=>(9*e+5)%16),_i=(()=>{const n=[[Si],[Mc]];for(let r=0;r<4;r++)for(let o of n)o.push(o[r].map(i=>Vc[i]));return n})(),ki=_i[0],Hi=_i[1],$i=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),Gc=ki.map((e,t)=>e.map(n=>$i[t][n])),Yc=Hi.map((e,t)=>e.map(n=>$i[t][n])),jc=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Zc=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function yo(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const X0=new Uint32Array(16);class Xc extends ti{h0=1732584193;h1=-271733879;h2=-1732584194;h3=271733878;h4=-1009589776;constructor(){super(64,20,8,!0)}get(){const{h0:t,h1:n,h2:r,h3:o,h4:i}=this;return[t,n,r,o,i]}set(t,n,r,o,i){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=i|0}process(t,n){for(let d=0;d<16;d++,n+=4)X0[d]=t.getUint32(n,!0);let r=this.h0|0,o=r,i=this.h1|0,s=i,a=this.h2|0,f=a,c=this.h3|0,x=c,h=this.h4|0,u=h;for(let d=0;d<5;d++){const l=4-d,E=jc[d],p=Zc[d],y=ki[d],w=Hi[d],g=Gc[d],v=Yc[d];for(let b=0;b<16;b++){const C=Y0(r+yo(d,i,a,c)+X0[y[b]]+E,g[b])+h|0;r=h,h=c,c=Y0(a,10)|0,a=i,i=C}for(let b=0;b<16;b++){const C=Y0(o+yo(l,s,f,x)+X0[w[b]]+p,v[b])+u|0;o=u,u=x,x=Y0(f,10)|0,f=s,s=C}}this.set(this.h1+a+x|0,this.h2+c+u|0,this.h3+h+o|0,this.h4+r+s|0,this.h0+i+f|0)}roundClean(){w0(X0)}destroy(){this.destroyed=!0,w0(this.buffer),this.set(0,0,0,0,0)}}const Qc=ei(()=>new Xc),ee=Uint8Array.of(),Ii=Uint8Array.of(0);function v0(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Be(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Jc(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];if(!Be(o))throw new Error("Uint8Array expected");t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const i=e[r];n.set(i,o),o+=i.length}return n}const Ri=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function N0(e){return Object.prototype.toString.call(e)==="[object Object]"}function ke(e){return Number.isSafeInteger(e)}const Yr={equalBytes:v0,isBytes:Be,concatBytes:Jc},Li=e=>{if(e!==null&&typeof e!="string"&&!De(e)&&!Be(e)&&!ke(e))throw new Error(`lengthCoder: expected null | number | Uint8Array | CoderType, got ${e} (${typeof e})`);return{encodeStream(t,n){if(e===null)return;if(De(e))return e.encodeStream(t,n);let r;if(typeof e=="number"?r=e:typeof e=="string"&&(r=Re.resolve(t.stack,e)),typeof r=="bigint"&&(r=Number(r)),r===void 0||r!==n)throw t.err(`Wrong length: ${r} len=${e} exp=${n} (${typeof n})`)},decodeStream(t){let n;if(De(e)?n=Number(e.decodeStream(t)):typeof e=="number"?n=e:typeof e=="string"&&(n=Re.resolve(t.stack,e)),typeof n=="bigint"&&(n=Number(n)),typeof n!="number")throw t.err(`Wrong length: ${n}`);return n}}},ne={BITS:32,FULL_MASK:-1>>>0,len:e=>Math.ceil(e/32),create:e=>new Uint32Array(ne.len(e)),clean:e=>e.fill(0),debug:e=>Array.from(e).map(t=>(t>>>0).toString(2).padStart(32,"0")),checkLen:(e,t)=>{if(ne.len(t)!==e.length)throw new Error(`wrong length=${e.length}. Expected: ${ne.len(t)}`)},chunkLen:(e,t,n)=>{if(t<0)throw new Error(`wrong pos=${t}`);if(t+n>e)throw new Error(`wrong range=${t}/${n} of ${e}`)},set:(e,t,n,r=!0)=>!r&&(e[t]&n)!==0?!1:(e[t]|=n,!0),pos:(e,t)=>({chunk:Math.floor((e+t)/32),mask:1<<32-(e+t)%32-1}),indices:(e,t,n=!1)=>{ne.checkLen(e,t);const{FULL_MASK:r,BITS:o}=ne,i=o-t%o,s=i?r>>>i<<i:r,a=[];for(let f=0;f<e.length;f++){let c=e[f];if(n&&(c=~c),f===e.length-1&&(c&=s),c!==0)for(let x=0;x<o;x++){const h=1<<o-x-1;c&h&&a.push(f*o+x)}}return a},range:e=>{const t=[];let n;for(const r of e)n===void 0||r!==n.pos+n.length?t.push(n={pos:r,length:1}):n.length+=1;return t},rangeDebug:(e,t,n=!1)=>`[${ne.range(ne.indices(e,t,n)).map(r=>`(${r.pos}/${r.length})`).join(", ")}]`,setRange:(e,t,n,r,o=!0)=>{ne.chunkLen(t,n,r);const{FULL_MASK:i,BITS:s}=ne,a=n%s?Math.floor(n/s):void 0,f=n+r,c=f%s?Math.floor(f/s):void 0;if(a!==void 0&&a===c)return ne.set(e,a,i>>>s-r<<s-r-n,o);if(a!==void 0&&!ne.set(e,a,i>>>n%s,o))return!1;const x=a!==void 0?a+1:n/s,h=c!==void 0?c:f/s;for(let u=x;u<h;u++)if(!ne.set(e,u,i,o))return!1;return!(c!==void 0&&a!==c&&!ne.set(e,c,i<<s-f%s,o))}},Re={pushObj:(e,t,n)=>{const r={obj:t};e.push(r),n((o,i)=>{r.field=o,i(),r.field=void 0}),e.pop()},path:e=>{const t=[];for(const n of e)n.field!==void 0&&t.push(n.field);return t.join("/")},err:(e,t,n)=>{const r=new Error(`${e}(${Re.path(t)}): ${typeof n=="string"?n:n.message}`);return n instanceof Error&&n.stack&&(r.stack=n.stack),r},resolve:(e,t)=>{const n=t.split("/"),r=e.map(s=>s.obj);let o=0;for(;o<n.length&&n[o]==="..";o++)r.pop();let i=r.pop();for(;o<n.length;o++){if(!i||i[n[o]]===void 0)return;i=i[n[o]]}return i}};class jr{pos=0;data;opts;stack;parent;parentOffset;bitBuf=0;bitPos=0;bs;view;constructor(t,n={},r=[],o=void 0,i=0){this.data=t,this.opts=n,this.stack=r,this.parent=o,this.parentOffset=i,this.view=Ri(t)}_enablePointers(){if(this.parent)return this.parent._enablePointers();this.bs||(this.bs=ne.create(this.data.length),ne.setRange(this.bs,this.data.length,0,this.pos,this.opts.allowMultipleReads))}markBytesBS(t,n){return this.parent?this.parent.markBytesBS(this.parentOffset+t,n):!n||!this.bs?!0:ne.setRange(this.bs,this.data.length,t,n,!1)}markBytes(t){const n=this.pos;this.pos+=t;const r=this.markBytesBS(n,t);if(!this.opts.allowMultipleReads&&!r)throw this.err(`multiple read pos=${this.pos} len=${t}`);return r}pushObj(t,n){return Re.pushObj(this.stack,t,n)}readView(t,n){if(!Number.isFinite(t))throw this.err(`readView: wrong length=${t}`);if(this.pos+t>this.data.length)throw this.err("readView: Unexpected end of buffer");const r=n(this.view,this.pos);return this.markBytes(t),r}absBytes(t){if(t>this.data.length)throw new Error("Unexpected end of buffer");return this.data.subarray(t)}finish(){if(!this.opts.allowUnreadBytes){if(this.bitPos)throw this.err(`${this.bitPos} bits left after unpack: ${Q.encode(this.data.slice(this.pos))}`);if(this.bs&&!this.parent){const t=ne.indices(this.bs,this.data.length,!0);if(t.length){const n=ne.range(t).map(({pos:r,length:o})=>`(${r}/${o})[${Q.encode(this.data.subarray(r,r+o))}]`).join(", ");throw this.err(`unread byte ranges: ${n} (total=${this.data.length})`)}else return}if(!this.isEnd())throw this.err(`${this.leftBytes} bytes ${this.bitPos} bits left after unpack: ${Q.encode(this.data.slice(this.pos))}`)}}err(t){return Re.err("Reader",this.stack,t)}offsetReader(t){if(t>this.data.length)throw this.err("offsetReader: Unexpected end of buffer");return new jr(this.absBytes(t),this.opts,this.stack,this,t)}bytes(t,n=!1){if(this.bitPos)throw this.err("readBytes: bitPos not empty");if(!Number.isFinite(t))throw this.err(`readBytes: wrong length=${t}`);if(this.pos+t>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const r=this.data.subarray(this.pos,this.pos+t);return n||this.markBytes(t),r}byte(t=!1){if(this.bitPos)throw this.err("readByte: bitPos not empty");if(this.pos+1>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const n=this.data[this.pos];return t||this.markBytes(1),n}get leftBytes(){return this.data.length-this.pos}get totalBytes(){return this.data.length}isEnd(){return this.pos>=this.data.length&&!this.bitPos}bits(t){if(t>32)throw this.err("BitReader: cannot read more than 32 bits in single call");let n=0;for(;t;){this.bitPos||(this.bitBuf=this.byte(),this.bitPos=8);const r=Math.min(t,this.bitPos);this.bitPos-=r,n=n<<r|this.bitBuf>>this.bitPos&2**r-1,this.bitBuf&=2**this.bitPos-1,t-=r}return n>>>0}find(t,n=this.pos){if(!Be(t))throw this.err(`find: needle is not bytes! ${t}`);if(this.bitPos)throw this.err("findByte: bitPos not empty");if(!t.length)throw this.err("find: needle is empty");for(let r=n;(r=this.data.indexOf(t[0],r))!==-1;r++){if(r===-1||this.data.length-r<t.length)return;if(v0(t,this.data.subarray(r,r+t.length)))return r}}}class ef{pos=0;stack;buffers=[];ptrs=[];bitBuf=0;bitPos=0;viewBuf=new Uint8Array(8);view;finished=!1;constructor(t=[]){this.stack=t,this.view=Ri(this.viewBuf)}pushObj(t,n){return Re.pushObj(this.stack,t,n)}writeView(t,n){if(this.finished)throw this.err("buffer: finished");if(!ke(t)||t>8)throw new Error(`wrong writeView length=${t}`);n(this.view),this.bytes(this.viewBuf.slice(0,t)),this.viewBuf.fill(0)}err(t){if(this.finished)throw this.err("buffer: finished");return Re.err("Reader",this.stack,t)}bytes(t){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeBytes: ends with non-empty bit buffer");this.buffers.push(t),this.pos+=t.length}byte(t){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeByte: ends with non-empty bit buffer");this.buffers.push(new Uint8Array([t])),this.pos++}finish(t=!0){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("buffer: ends with non-empty bit buffer");const n=this.buffers.concat(this.ptrs.map(i=>i.buffer)),r=n.map(i=>i.length).reduce((i,s)=>i+s,0),o=new Uint8Array(r);for(let i=0,s=0;i<n.length;i++){const a=n[i];o.set(a,s),s+=a.length}for(let i=this.pos,s=0;s<this.ptrs.length;s++){const a=this.ptrs[s];o.set(a.ptr.encode(i),a.pos),i+=a.buffer.length}if(t){this.buffers=[];for(const i of this.ptrs)i.buffer.fill(0);this.ptrs=[],this.finished=!0,this.bitBuf=0}return o}bits(t,n){if(n>32)throw this.err("writeBits: cannot write more than 32 bits in single call");if(t>=2**n)throw this.err(`writeBits: value (${t}) >= 2**bits (${n})`);for(;n;){const r=Math.min(n,8-this.bitPos);this.bitBuf=this.bitBuf<<r|t>>n-r,this.bitPos+=r,n-=r,t&=2**n-1,this.bitPos===8&&(this.bitPos=0,this.buffers.push(new Uint8Array([this.bitBuf])),this.pos++)}}}const kr=e=>Uint8Array.from(e).reverse();function tf(e,t,n){if(n){const r=2n**(t-1n);if(e<-r||e>=r)throw new Error(`value out of signed bounds. Expected ${-r} <= ${e} < ${r}`)}else if(0n>e||e>=2n**t)throw new Error(`value out of unsigned bounds. Expected 0 <= ${e} < ${2n**t}`)}function Ti(e){return{encodeStream:e.encodeStream,decodeStream:e.decodeStream,size:e.size,encode:t=>{const n=new ef;return e.encodeStream(n,t),n.finish()},decode:(t,n={})=>{const r=new jr(t,n),o=e.decodeStream(r);return r.finish(),o}}}function ve(e,t){if(!De(e))throw new Error(`validate: invalid inner value ${e}`);if(typeof t!="function")throw new Error("validate: fn should be function");return Ti({size:e.size,encodeStream:(n,r)=>{let o;try{o=t(r)}catch(i){throw n.err(i)}e.encodeStream(n,o)},decodeStream:n=>{const r=e.decodeStream(n);try{return t(r)}catch(o){throw n.err(o)}}})}const pe=e=>{const t=Ti(e);return e.validate?ve(t,e.validate):t},sr=e=>N0(e)&&typeof e.decode=="function"&&typeof e.encode=="function";function De(e){return N0(e)&&sr(e)&&typeof e.encodeStream=="function"&&typeof e.decodeStream=="function"&&(e.size===void 0||ke(e.size))}function rf(){return{encode:e=>{if(!Array.isArray(e))throw new Error("array expected");const t={};for(const n of e){if(!Array.isArray(n)||n.length!==2)throw new Error("array of two elements expected");const r=n[0],o=n[1];if(t[r]!==void 0)throw new Error(`key(${r}) appears twice in struct`);t[r]=o}return t},decode:e=>{if(!N0(e))throw new Error(`expected plain object, got ${e}`);return Object.entries(e)}}}const nf={encode:e=>{if(typeof e!="bigint")throw new Error(`expected bigint, got ${typeof e}`);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error(`element bigger than MAX_SAFE_INTEGER=${e}`);return Number(e)},decode:e=>{if(!ke(e))throw new Error("element is not a safe integer");return BigInt(e)}};function of(e){if(!N0(e))throw new Error("plain object expected");return{encode:t=>{if(!ke(t)||!(t in e))throw new Error(`wrong value ${t}`);return e[t]},decode:t=>{if(typeof t!="string")throw new Error(`wrong value ${typeof t}`);return e[t]}}}function sf(e,t=!1){if(!ke(e))throw new Error(`decimal/precision: wrong value ${e}`);if(typeof t!="boolean")throw new Error(`decimal/round: expected boolean, got ${typeof t}`);const n=10n**BigInt(e);return{encode:r=>{if(typeof r!="bigint")throw new Error(`expected bigint, got ${typeof r}`);let o=(r<0n?-r:r).toString(10),i=o.length-e;i<0&&(o=o.padStart(o.length-i,"0"),i=0);let s=o.length-1;for(;s>=i&&o[s]==="0";s--);let a=o.slice(0,i),f=o.slice(i,s+1);return a||(a="0"),r<0n&&(a="-"+a),f?`${a}.${f}`:a},decode:r=>{if(typeof r!="string")throw new Error(`expected string, got ${typeof r}`);if(r==="-0")throw new Error("negative zero is not allowed");let o=!1;if(r.startsWith("-")&&(o=!0,r=r.slice(1)),!/^(0|[1-9]\d*)(\.\d+)?$/.test(r))throw new Error(`wrong string value=${r}`);let i=r.indexOf(".");i=i===-1?r.length:i;const s=r.slice(0,i),a=r.slice(i+1).replace(/0+$/,""),f=BigInt(s)*n;if(!t&&a.length>e)throw new Error(`fractional part cannot be represented with this precision (num=${r}, prec=${e})`);const c=Math.min(a.length,e),x=BigInt(a.slice(0,c))*10n**BigInt(e-c),h=f+x;return o?-h:h}}}function af(e){if(!Array.isArray(e))throw new Error(`expected array, got ${typeof e}`);for(const t of e)if(!sr(t))throw new Error(`wrong base coder ${t}`);return{encode:t=>{for(const n of e){const r=n.encode(t);if(r!==void 0)return r}throw new Error(`match/encode: cannot find match in ${t}`)},decode:t=>{for(const n of e){const r=n.decode(t);if(r!==void 0)return r}throw new Error(`match/decode: cannot find match in ${t}`)}}}const Ui=e=>{if(!sr(e))throw new Error("BaseCoder expected");return{encode:e.decode,decode:e.encode}},ar={dict:rf,numberBigint:nf,tsEnum:of,decimal:sf,match:af,reverse:Ui},Zr=(e,t=!1,n=!1,r=!0)=>{if(!ke(e))throw new Error(`bigint/size: wrong value ${e}`);if(typeof t!="boolean")throw new Error(`bigint/le: expected boolean, got ${typeof t}`);if(typeof n!="boolean")throw new Error(`bigint/signed: expected boolean, got ${typeof n}`);if(typeof r!="boolean")throw new Error(`bigint/sized: expected boolean, got ${typeof r}`);const o=BigInt(e),i=2n**(8n*o-1n);return pe({size:r?e:void 0,encodeStream:(s,a)=>{n&&a<0&&(a=a|i);const f=[];for(let x=0;x<e;x++)f.push(Number(a&255n)),a>>=8n;let c=new Uint8Array(f).reverse();if(!r){let x=0;for(x=0;x<c.length&&c[x]===0;x++);c=c.subarray(x)}s.bytes(t?c.reverse():c)},decodeStream:s=>{const a=s.bytes(r?e:Math.min(e,s.leftBytes)),f=t?a:kr(a);let c=0n;for(let x=0;x<f.length;x++)c|=BigInt(f[x])<<8n*BigInt(x);return n&&c&i&&(c=(c^i)-i),c},validate:s=>{if(typeof s!="bigint")throw new Error(`bigint: invalid value: ${s}`);return tf(s,8n*o,!!n),s}})},cf=Zr(32,!1),Ot=Zr(8,!0),ff=Zr(8,!0,!0),xf=(e,t)=>pe({size:e,encodeStream:(n,r)=>n.writeView(e,o=>t.write(o,r)),decodeStream:n=>n.readView(e,t.read),validate:n=>{if(typeof n!="number")throw new Error(`viewCoder: expected number, got ${typeof n}`);return t.validate&&t.validate(n),n}}),q0=(e,t,n)=>{const r=e*8,o=2**(r-1),i=f=>{if(!ke(f))throw new Error(`sintView: value is not safe integer: ${f}`);if(f<-o||f>=o)throw new Error(`sintView: value out of bounds. Expected ${-o} <= ${f} < ${o}`)},s=2**r,a=f=>{if(!ke(f))throw new Error(`uintView: value is not safe integer: ${f}`);if(0>f||f>=s)throw new Error(`uintView: value out of bounds. Expected 0 <= ${f} < ${s}`)};return xf(e,{write:n.write,read:n.read,validate:t?i:a})},Y=q0(4,!1,{read:(e,t)=>e.getUint32(t,!0),write:(e,t)=>e.setUint32(0,t,!0)}),uf=q0(4,!1,{read:(e,t)=>e.getUint32(t,!1),write:(e,t)=>e.setUint32(0,t,!1)}),u0=q0(4,!0,{read:(e,t)=>e.getInt32(t,!0),write:(e,t)=>e.setInt32(0,t,!0)}),bo=q0(2,!1,{read:(e,t)=>e.getUint16(t,!0),write:(e,t)=>e.setUint16(0,t,!0)}),Me=q0(1,!1,{read:(e,t)=>e.getUint8(t),write:(e,t)=>e.setUint8(0,t)}),J=(e,t=!1)=>{if(typeof t!="boolean")throw new Error(`bytes/le: expected boolean, got ${typeof t}`);const n=Li(e),r=Be(e);return pe({size:typeof e=="number"?e:void 0,encodeStream:(o,i)=>{r||n.encodeStream(o,i.length),o.bytes(t?kr(i):i),r&&o.bytes(e)},decodeStream:o=>{let i;if(r){const s=o.find(e);if(!s)throw o.err("bytes: cannot find terminator");i=o.bytes(s-o.pos),o.bytes(e.length)}else i=o.bytes(e===null?o.leftBytes:n.decodeStream(o));return t?kr(i):i},validate:o=>{if(!Be(o))throw new Error(`bytes: invalid value ${o}`);return o}})};function hf(e,t){if(!De(t))throw new Error(`prefix: invalid inner value ${t}`);return t0(J(e),Ui(t))}const Xr=(e,t=!1)=>ve(t0(J(e,t),nc),n=>{if(typeof n!="string")throw new Error(`expected string, got ${typeof n}`);return n}),df=(e,t={isLE:!1,with0x:!1})=>{let n=t0(J(e,t.isLE),Q);const r=t.with0x;if(typeof r!="boolean")throw new Error(`hex/with0x: expected boolean, got ${typeof r}`);return r&&(n=t0(n,{encode:o=>`0x${o}`,decode:o=>{if(!o.startsWith("0x"))throw new Error("hex(with0x=true).encode input should start with 0x");return o.slice(2)}})),n};function t0(e,t){if(!De(e))throw new Error(`apply: invalid inner value ${e}`);if(!sr(t))throw new Error(`apply: invalid base value ${e}`);return pe({size:e.size,encodeStream:(n,r)=>{let o;try{o=t.decode(r)}catch(i){throw n.err(""+i)}return e.encodeStream(n,o)},decodeStream:n=>{const r=e.decodeStream(n);try{return t.encode(r)}catch(o){throw n.err(""+o)}}})}const lf=(e,t=!1)=>{if(!Be(e))throw new Error(`flag/flagValue: expected Uint8Array, got ${typeof e}`);if(typeof t!="boolean")throw new Error(`flag/xor: expected boolean, got ${typeof t}`);return pe({size:e.length,encodeStream:(n,r)=>{!!r!==t&&n.bytes(e)},decodeStream:n=>{let r=n.leftBytes>=e.length;return r&&(r=v0(n.bytes(e.length,!0),e),r&&n.bytes(e.length)),r!==t},validate:n=>{if(n!==void 0&&typeof n!="boolean")throw new Error(`flag: expected boolean value or undefined, got ${typeof n}`);return n}})};function pf(e,t,n){if(!De(t))throw new Error(`flagged: invalid inner value ${t}`);return pe({encodeStream:(r,o)=>{Re.resolve(r.stack,e)&&t.encodeStream(r,o)},decodeStream:r=>{let o=!1;if(o=!!Re.resolve(r.stack,e),o)return t.decodeStream(r)}})}function Qr(e,t,n=!0){if(!De(e))throw new Error(`magic: invalid inner value ${e}`);if(typeof n!="boolean")throw new Error(`magic: expected boolean, got ${typeof n}`);return pe({size:e.size,encodeStream:(r,o)=>e.encodeStream(r,t),decodeStream:r=>{const o=e.decodeStream(r);if(n&&typeof o!="object"&&o!==t||Be(t)&&!v0(t,o))throw r.err(`magic: invalid value: ${o} !== ${t}`)},validate:r=>{if(r!==void 0)throw new Error(`magic: wrong value=${typeof r}`);return r}})}function Oi(e){let t=0;for(const n of e){if(n.size===void 0)return;if(!ke(n.size))throw new Error(`sizeof: wrong element size=${t}`);t+=n.size}return t}function ce(e){if(!N0(e))throw new Error(`struct: expected plain object, got ${e}`);for(const t in e)if(!De(e[t]))throw new Error(`struct: field ${t} is not CoderType`);return pe({size:Oi(Object.values(e)),encodeStream:(t,n)=>{t.pushObj(n,r=>{for(const o in e)r(o,()=>e[o].encodeStream(t,n[o]))})},decodeStream:t=>{const n={};return t.pushObj(n,r=>{for(const o in e)r(o,()=>n[o]=e[o].decodeStream(t))}),n},validate:t=>{if(typeof t!="object"||t===null)throw new Error(`struct: invalid value ${t}`);return t}})}function gf(e){if(!Array.isArray(e))throw new Error(`Packed.Tuple: got ${typeof e} instead of array`);for(let t=0;t<e.length;t++)if(!De(e[t]))throw new Error(`tuple: field ${t} is not CoderType`);return pe({size:Oi(e),encodeStream:(t,n)=>{if(!Array.isArray(n))throw t.err(`tuple: invalid value ${n}`);t.pushObj(n,r=>{for(let o=0;o<e.length;o++)r(`${o}`,()=>e[o].encodeStream(t,n[o]))})},decodeStream:t=>{const n=[];return t.pushObj(n,r=>{for(let o=0;o<e.length;o++)r(`${o}`,()=>n.push(e[o].decodeStream(t)))}),n},validate:t=>{if(!Array.isArray(t))throw new Error(`tuple: invalid value ${t}`);if(t.length!==e.length)throw new Error(`tuple: wrong length=${t.length}, expected ${e.length}`);return t}})}function le(e,t){if(!De(t))throw new Error(`array: invalid inner value ${t}`);const n=Li(typeof e=="string"?`../${e}`:e);return pe({size:typeof e=="number"&&t.size?e*t.size:void 0,encodeStream:(r,o)=>{const i=r;i.pushObj(o,s=>{Be(e)||n.encodeStream(r,o.length);for(let a=0;a<o.length;a++)s(`${a}`,()=>{const f=o[a],c=r.pos;if(t.encodeStream(r,f),Be(e)){if(e.length>i.pos-c)return;const x=i.finish(!1).subarray(c,i.pos);if(v0(x.subarray(0,e.length),e))throw i.err(`array: inner element encoding same as separator. elm=${f} data=${x}`)}})}),Be(e)&&r.bytes(e)},decodeStream:r=>{const o=[];return r.pushObj(o,i=>{if(e===null)for(let s=0;!r.isEnd()&&(i(`${s}`,()=>o.push(t.decodeStream(r))),!(t.size&&r.leftBytes<t.size));s++);else if(Be(e))for(let s=0;;s++){if(v0(r.bytes(e.length,!0),e)){r.bytes(e.length);break}i(`${s}`,()=>o.push(t.decodeStream(r)))}else{let s;i("arrayLen",()=>s=n.decodeStream(r));for(let a=0;a<s;a++)i(`${a}`,()=>o.push(t.decodeStream(r)))}}),o},validate:r=>{if(!Array.isArray(r))throw new Error(`array: invalid value ${r}`);return r}})}const b0=x0.Point,Bo=b0.Fn,Pi=b0.Fn.ORDER,Ni=e=>e%2n===0n,Z=Yr.isBytes,Ze=Yr.concatBytes,ae=Yr.equalBytes,Jr=e=>Qc(ue(e)),Ke=(...e)=>ue(ue(Ze(...e))),qi=i0.getPublicKey,wf=x0.getPublicKey,Ao=e=>e.r<Pi/2n;function Ef(e,t,n=!1){let r=x0.Signature.fromBytes(x0.sign(e,t,{prehash:!1}));if(n&&!Ao(r)){const o=new Uint8Array(32);let i=0;for(;!Ao(r);)if(o.set(Y.encode(i++)),r=x0.Signature.fromBytes(x0.sign(e,t,{prehash:!1,extraEntropy:o})),i>4294967295)throw new Error("lowR counter overflow: report the error")}return r.toBytes("der")}const Co=i0.sign,Wi=i0.utils.taggedHash,Ee={ecdsa:0,schnorr:1};function y0(e,t){const n=e.length;if(t===Ee.ecdsa){if(n===32)throw new Error("Expected non-Schnorr key");return b0.fromBytes(e),e}else if(t===Ee.schnorr){if(n!==32)throw new Error("Expected 32-byte Schnorr key");return i0.utils.lift_x(Le(e)),e}else throw new Error("Unknown key type")}function zi(e,t){const r=i0.utils.taggedHash("TapTweak",e,t),o=Le(r);if(o>=Pi)throw new Error("tweak higher than curve order");return o}function vf(e,t=Uint8Array.of()){const n=i0.utils,r=Le(e),o=b0.BASE.multiply(r),i=Ni(o.y)?r:Bo.neg(r),s=n.pointToBytes(o),a=zi(s,t);return nr(Bo.add(i,a),32)}function yf(e,t){const n=i0.utils,r=zi(e,t),i=n.lift_x(Le(e)).add(b0.BASE.multiply(r)),s=Ni(i.y)?0:1;return[n.pointToBytes(i),s]}ue(b0.BASE.toBytes(!1));const O0={bech32:"bc",pubKeyHash:0,scriptHash:5,wif:128},cx={bech32:"tb",pubKeyHash:111,scriptHash:196,wif:239};function mo(e,t){if(!Z(e)||!Z(t))throw new Error(`cmp: wrong type a=${typeof e} b=${typeof t}`);const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)if(e[r]!=t[r])return Math.sign(e[r]-t[r]);return Math.sign(e.length-t.length)}function Ki(e){const t={};for(const n in e){if(t[e[n]]!==void 0)throw new Error("duplicate key");t[e[n]]=n}return t}const ie={OP_0:0,PUSHDATA1:76,PUSHDATA2:77,PUSHDATA4:78,"1NEGATE":79,RESERVED:80,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,NOP:97,VER:98,IF:99,NOTIF:100,VERIF:101,VERNOTIF:102,ELSE:103,ENDIF:104,VERIFY:105,RETURN:106,TOALTSTACK:107,FROMALTSTACK:108,"2DROP":109,"2DUP":110,"3DUP":111,"2OVER":112,"2ROT":113,"2SWAP":114,IFDUP:115,DEPTH:116,DROP:117,DUP:118,NIP:119,OVER:120,PICK:121,ROLL:122,ROT:123,SWAP:124,TUCK:125,CAT:126,SUBSTR:127,LEFT:128,RIGHT:129,SIZE:130,INVERT:131,AND:132,OR:133,XOR:134,EQUAL:135,EQUALVERIFY:136,RESERVED1:137,RESERVED2:138,"1ADD":139,"1SUB":140,"2MUL":141,"2DIV":142,NEGATE:143,ABS:144,NOT:145,"0NOTEQUAL":146,ADD:147,SUB:148,MUL:149,DIV:150,MOD:151,LSHIFT:152,RSHIFT:153,BOOLAND:154,BOOLOR:155,NUMEQUAL:156,NUMEQUALVERIFY:157,NUMNOTEQUAL:158,LESSTHAN:159,GREATERTHAN:160,LESSTHANOREQUAL:161,GREATERTHANOREQUAL:162,MIN:163,MAX:164,WITHIN:165,RIPEMD160:166,SHA1:167,SHA256:168,HASH160:169,HASH256:170,CODESEPARATOR:171,CHECKSIG:172,CHECKSIGVERIFY:173,CHECKMULTISIG:174,CHECKMULTISIGVERIFY:175,NOP1:176,CHECKLOCKTIMEVERIFY:177,CHECKSEQUENCEVERIFY:178,NOP4:179,NOP5:180,NOP6:181,NOP7:182,NOP8:183,NOP9:184,NOP10:185,CHECKSIGADD:186,INVALID:255},bf=Ki(ie);function Vi(e=6,t=!1){return pe({encodeStream:(n,r)=>{if(r===0n)return;const o=r<0,i=BigInt(r),s=[];for(let a=o?-i:i;a;a>>=8n)s.push(Number(a&0xffn));s[s.length-1]>=128?s.push(o?128:0):o&&(s[s.length-1]|=128),n.bytes(new Uint8Array(s))},decodeStream:n=>{const r=n.leftBytes;if(r>e)throw new Error(`ScriptNum: number (${r}) bigger than limit=${e}`);if(r===0)return 0n;if(t){const s=n.bytes(r,!0);if((s[s.length-1]&127)===0&&(r<=1||(s[s.length-2]&128)===0))throw new Error("Non-minimally encoded ScriptNum")}let o=0,i=0n;for(let s=0;s<r;++s)o=n.byte(),i|=BigInt(o)<<8n*BigInt(s);return o>=128&&(i&=2n**BigInt(r*8)-1n>>1n,i=-i),i}})}function Bf(e,t=4,n=!0){if(typeof e=="number")return e;if(Z(e))try{const r=Vi(t,n).decode(e);return r>Number.MAX_SAFE_INTEGER?void 0:Number(r)}catch{return}}const re=pe({encodeStream:(e,t)=>{for(let n of t){if(typeof n=="string"){if(ie[n]===void 0)throw new Error(`Unknown opcode=${n}`);e.byte(ie[n]);continue}else if(typeof n=="number"){if(n===0){e.byte(0);continue}else if(1<=n&&n<=16){e.byte(ie.OP_1-1+n);continue}}if(typeof n=="number"&&(n=Vi().encode(BigInt(n))),!Z(n))throw new Error(`Wrong Script OP=${n} (${typeof n})`);const r=n.length;r<ie.PUSHDATA1?e.byte(r):r<=255?(e.byte(ie.PUSHDATA1),e.byte(r)):r<=65535?(e.byte(ie.PUSHDATA2),e.bytes(bo.encode(r))):(e.byte(ie.PUSHDATA4),e.bytes(Y.encode(r))),e.bytes(n)}},decodeStream:e=>{const t=[];for(;!e.isEnd();){const n=e.byte();if(ie.OP_0<n&&n<=ie.PUSHDATA4){let r;if(n<ie.PUSHDATA1)r=n;else if(n===ie.PUSHDATA1)r=Me.decodeStream(e);else if(n===ie.PUSHDATA2)r=bo.decodeStream(e);else if(n===ie.PUSHDATA4)r=Y.decodeStream(e);else throw new Error("Should be not possible");t.push(e.bytes(r))}else if(n===0)t.push(0);else if(ie.OP_1<=n&&n<=ie.OP_16)t.push(n-(ie.OP_1-1));else{const r=bf[n];if(r===void 0)throw new Error(`Unknown opcode=${n.toString(16)}`);t.push(r)}}return t}}),Do={253:[253,2,253n,65535n],254:[254,4,65536n,4294967295n],255:[255,8,4294967296n,18446744073709551615n]},cr=pe({encodeStream:(e,t)=>{if(typeof t=="number"&&(t=BigInt(t)),0n<=t&&t<=252n)return e.byte(Number(t));for(const[n,r,o,i]of Object.values(Do))if(!(o>t||t>i)){e.byte(n);for(let s=0;s<r;s++)e.byte(Number(t>>8n*BigInt(s)&0xffn));return}throw e.err(`VarInt too big: ${t}`)},decodeStream:e=>{const t=e.byte();if(t<=252)return BigInt(t);const[n,r,o]=Do[t];let i=0n;for(let s=0;s<r;s++)i|=BigInt(e.byte())<<8n*BigInt(s);if(i<o)throw e.err(`Wrong CompactSize(${8*r})`);return i}}),Fe=t0(cr,ar.numberBigint),me=J(cr),en=le(Fe,me),jt=e=>le(cr,e),Mi=ce({txid:J(32,!0),index:Y,finalScriptSig:me,sequence:Y}),Je=ce({amount:Ot,script:me}),Af=ce({version:u0,segwitFlag:lf(new Uint8Array([0,1])),inputs:jt(Mi),outputs:jt(Je),witnesses:pf("segwitFlag",le("inputs/length",en)),lockTime:Y});function Cf(e){if(e.segwitFlag&&e.witnesses&&!e.witnesses.length)throw new Error("Segwit flag with empty witnesses array");return e}const l0=ve(Af,Cf),k0=ce({version:u0,inputs:jt(Mi),outputs:jt(Je),lockTime:Y}),Hr=ve(J(null),e=>y0(e,Ee.ecdsa)),Zt=ve(J(32),e=>y0(e,Ee.schnorr)),Fo=ve(J(null),e=>{if(e.length!==64&&e.length!==65)throw new Error("Schnorr signature should be 64 or 65 bytes long");return e}),fr=ce({fingerprint:uf,path:le(null,Y)}),Gi=ce({hashes:le(Fe,J(32)),der:fr}),mf=J(78),Df=ce({pubKey:Zt,leafHash:J(32)}),Ff=ce({version:Me,internalKey:J(32),merklePath:le(null,J(32))}),H0=ve(Ff,e=>{if(e.merklePath.length>128)throw new Error("TaprootControlBlock: merklePath should be of length 0..128 (inclusive)");return e}),Sf=le(null,ce({depth:Me,version:Me,script:me})),te=J(null),So=J(20),S0=J(32),tn={unsignedTx:[0,!1,k0,[0],[0],!1],xpub:[1,mf,fr,[],[0,2],!1],txVersion:[2,!1,Y,[2],[2],!1],fallbackLocktime:[3,!1,Y,[],[2],!1],inputCount:[4,!1,Fe,[2],[2],!1],outputCount:[5,!1,Fe,[2],[2],!1],txModifiable:[6,!1,Me,[],[2],!1],version:[251,!1,Y,[],[0,2],!1],proprietary:[252,te,te,[],[0,2],!1]},xr={nonWitnessUtxo:[0,!1,l0,[],[0,2],!1],witnessUtxo:[1,!1,Je,[],[0,2],!1],partialSig:[2,Hr,te,[],[0,2],!1],sighashType:[3,!1,Y,[],[0,2],!1],redeemScript:[4,!1,te,[],[0,2],!1],witnessScript:[5,!1,te,[],[0,2],!1],bip32Derivation:[6,Hr,fr,[],[0,2],!1],finalScriptSig:[7,!1,te,[],[0,2],!1],finalScriptWitness:[8,!1,en,[],[0,2],!1],porCommitment:[9,!1,te,[],[0,2],!1],ripemd160:[10,So,te,[],[0,2],!1],sha256:[11,S0,te,[],[0,2],!1],hash160:[12,So,te,[],[0,2],!1],hash256:[13,S0,te,[],[0,2],!1],txid:[14,!1,S0,[2],[2],!0],index:[15,!1,Y,[2],[2],!0],sequence:[16,!1,Y,[],[2],!0],requiredTimeLocktime:[17,!1,Y,[],[2],!1],requiredHeightLocktime:[18,!1,Y,[],[2],!1],tapKeySig:[19,!1,Fo,[],[0,2],!1],tapScriptSig:[20,Df,Fo,[],[0,2],!1],tapLeafScript:[21,H0,te,[],[0,2],!1],tapBip32Derivation:[22,S0,Gi,[],[0,2],!1],tapInternalKey:[23,!1,Zt,[],[0,2],!1],tapMerkleRoot:[24,!1,S0,[],[0,2],!1],proprietary:[252,te,te,[],[0,2],!1]},_f=["txid","sequence","index","witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknown"],kf=["partialSig","finalScriptSig","finalScriptWitness","tapKeySig","tapScriptSig"],Xt={redeemScript:[0,!1,te,[],[0,2],!1],witnessScript:[1,!1,te,[],[0,2],!1],bip32Derivation:[2,Hr,fr,[],[0,2],!1],amount:[3,!1,ff,[2],[2],!0],script:[4,!1,te,[2],[2],!0],tapInternalKey:[5,!1,Zt,[],[0,2],!1],tapTree:[6,!1,Sf,[],[0,2],!1],tapBip32Derivation:[7,Zt,Gi,[],[0,2],!1],proprietary:[252,te,te,[],[0,2],!1]},Hf=[],_o=le(Ii,ce({key:hf(Fe,ce({type:Fe,key:J(null)})),value:J(Fe)}));function $r(e){const[t,n,r,o,i,s]=e;return{type:t,kc:n,vc:r,reqInc:o,allowInc:i,silentIgnore:s}}ce({type:Fe,key:J(null)});function rn(e){const t={};for(const n in e){const[r,o,i]=e[n];t[r]=[n,o,i]}return pe({encodeStream:(n,r)=>{let o=[];for(const i in e){const s=r[i];if(s===void 0)continue;const[a,f,c]=e[i];if(!f)o.push({key:{type:a,key:ee},value:c.encode(s)});else{const x=s.map(([h,u])=>[f.encode(h),c.encode(u)]);x.sort((h,u)=>mo(h[0],u[0]));for(const[h,u]of x)o.push({key:{key:h,type:a},value:u})}}if(r.unknown){r.unknown.sort((i,s)=>mo(i[0].key,s[0].key));for(const[i,s]of r.unknown)o.push({key:i,value:s})}_o.encodeStream(n,o)},decodeStream:n=>{const r=_o.decodeStream(n),o={},i={};for(const s of r){let a="unknown",f=s.key.key,c=s.value;if(t[s.key.type]){const[x,h,u]=t[s.key.type];if(a=x,!h&&f.length)throw new Error(`PSBT: Non-empty key for ${a} (key=${Q.encode(f)} value=${Q.encode(c)}`);if(f=h?h.decode(f):void 0,c=u.decode(c),!h){if(o[a])throw new Error(`PSBT: Same keys: ${a} (key=${f} value=${c})`);o[a]=c,i[a]=!0;continue}}else f={type:s.key.type,key:s.key.key};if(i[a])throw new Error(`PSBT: Key type with empty key and no key=${a} val=${c}`);o[a]||(o[a]=[]),o[a].push([f,c])}return o}})}const nn=ve(rn(xr),e=>{if(e.finalScriptWitness&&!e.finalScriptWitness.length)throw new Error("validateInput: empty finalScriptWitness");if(e.partialSig&&!e.partialSig.length)throw new Error("Empty partialSig");if(e.partialSig)for(const[t]of e.partialSig)y0(t,Ee.ecdsa);if(e.bip32Derivation)for(const[t]of e.bip32Derivation)y0(t,Ee.ecdsa);if(e.requiredTimeLocktime!==void 0&&e.requiredTimeLocktime<5e8)throw new Error(`validateInput: wrong timeLocktime=${e.requiredTimeLocktime}`);if(e.requiredHeightLocktime!==void 0&&(e.requiredHeightLocktime<=0||e.requiredHeightLocktime>=5e8))throw new Error(`validateInput: wrong heighLocktime=${e.requiredHeightLocktime}`);if(e.tapLeafScript)for(const[t,n]of e.tapLeafScript){if((t.version&254)!==n[n.length-1])throw new Error("validateInput: tapLeafScript version mimatch");if(n[n.length-1]&1)throw new Error("validateInput: tapLeafScript version has parity bit!")}return e}),on=ve(rn(Xt),e=>{if(e.bip32Derivation)for(const[t]of e.bip32Derivation)y0(t,Ee.ecdsa);return e}),Yi=ve(rn(tn),e=>{if((e.version||0)===0){if(!e.unsignedTx)throw new Error("PSBTv0: missing unsignedTx");for(const n of e.unsignedTx.inputs)if(n.finalScriptSig&&n.finalScriptSig.length)throw new Error("PSBTv0: input scriptSig found in unsignedTx")}return e}),$f=ce({magic:Qr(Xr(new Uint8Array([255])),"psbt"),global:Yi,inputs:le("global/unsignedTx/inputs/length",nn),outputs:le(null,on)}),If=ce({magic:Qr(Xr(new Uint8Array([255])),"psbt"),global:Yi,inputs:le("global/inputCount",nn),outputs:le("global/outputCount",on)});ce({magic:Qr(Xr(new Uint8Array([255])),"psbt"),items:le(null,t0(le(Ii,gf([df(Fe),J(cr)])),ar.dict()))});function Er(e,t,n){for(const r in n){if(r==="unknown"||!t[r])continue;const{allowInc:o}=$r(t[r]);if(!o.includes(e))throw new Error(`PSBTv${e}: field ${r} is not allowed`)}for(const r in t){const{reqInc:o}=$r(t[r]);if(o.includes(e)&&n[r]===void 0)throw new Error(`PSBTv${e}: missing required field ${r}`)}}function ko(e,t,n){const r={};for(const o in n){const i=o;if(i!=="unknown"){if(!t[i])continue;const{allowInc:s,silentIgnore:a}=$r(t[i]);if(!s.includes(e)){if(a)continue;throw new Error(`Failed to serialize in PSBTv${e}: ${i} but versions allows inclusion=${s}`)}}r[i]=n[i]}return r}function ji(e){const t=e&&e.global&&e.global.version||0;Er(t,tn,e.global);for(const s of e.inputs)Er(t,xr,s);for(const s of e.outputs)Er(t,Xt,s);const n=t?e.global.inputCount:e.global.unsignedTx.inputs.length;if(e.inputs.length<n)throw new Error("Not enough inputs");const r=e.inputs.slice(n);if(r.length>1||r.length&&Object.keys(r[0]).length)throw new Error(`Unexpected inputs left in tx=${r}`);const o=t?e.global.outputCount:e.global.unsignedTx.outputs.length;if(e.outputs.length<o)throw new Error("Not outputs inputs");const i=e.outputs.slice(o);if(i.length>1||i.length&&Object.keys(i[0]).length)throw new Error(`Unexpected outputs left in tx=${i}`);return e}function Ir(e,t,n,r,o){const i={...n,...t};for(const s in e){const a=s,[f,c,x]=e[a],h=r&&!r.includes(s);if(t[s]===void 0&&s in t){if(h)throw new Error(`Cannot remove signed field=${s}`);delete i[s]}else if(c){const u=n&&n[s]?n[s]:[];let d=t[a];if(d){if(!Array.isArray(d))throw new Error(`keyMap(${s}): KV pairs should be [k, v][]`);d=d.map(p=>{if(p.length!==2)throw new Error(`keyMap(${s}): KV pairs should be [k, v][]`);return[typeof p[0]=="string"?c.decode(Q.decode(p[0])):p[0],typeof p[1]=="string"?x.decode(Q.decode(p[1])):p[1]]});const l={},E=(p,y,w)=>{if(l[p]===void 0){l[p]=[y,w];return}const g=Q.encode(x.encode(l[p][1])),v=Q.encode(x.encode(w));if(g!==v)throw new Error(`keyMap(${a}): same key=${p} oldVal=${g} newVal=${v}`)};for(const[p,y]of u){const w=Q.encode(c.encode(p));E(w,p,y)}for(const[p,y]of d){const w=Q.encode(c.encode(p));if(y===void 0){if(h)throw new Error(`Cannot remove signed field=${a}/${p}`);delete l[w]}else E(w,p,y)}i[a]=Object.values(l)}}else if(typeof i[s]=="string")i[s]=x.decode(Q.decode(i[s]));else if(h&&s in t&&n&&n[s]!==void 0&&!ae(x.encode(t[s]),x.encode(n[s])))throw new Error(`Cannot change signed field=${s}`)}for(const s in i)if(!e[s]){if(o&&s==="unknown")continue;delete i[s]}return i}const Ho=ve($f,ji),$o=ve(If,ji),Rf={encode(e){if(!(e.length!==2||e[0]!==1||!Z(e[1])||Q.encode(e[1])!=="4e73"))return{type:"p2a",script:re.encode(e)}},decode:e=>{if(e.type==="p2a")return[1,Q.decode("4e73")]}};function h0(e,t){try{return y0(e,t),!0}catch{return!1}}const Lf={encode(e){if(!(e.length!==2||!Z(e[0])||!h0(e[0],Ee.ecdsa)||e[1]!=="CHECKSIG"))return{type:"pk",pubkey:e[0]}},decode:e=>e.type==="pk"?[e.pubkey,"CHECKSIG"]:void 0},Tf={encode(e){if(!(e.length!==5||e[0]!=="DUP"||e[1]!=="HASH160"||!Z(e[2]))&&!(e[3]!=="EQUALVERIFY"||e[4]!=="CHECKSIG"))return{type:"pkh",hash:e[2]}},decode:e=>e.type==="pkh"?["DUP","HASH160",e.hash,"EQUALVERIFY","CHECKSIG"]:void 0},Uf={encode(e){if(!(e.length!==3||e[0]!=="HASH160"||!Z(e[1])||e[2]!=="EQUAL"))return{type:"sh",hash:e[1]}},decode:e=>e.type==="sh"?["HASH160",e.hash,"EQUAL"]:void 0},Of={encode(e){if(!(e.length!==2||e[0]!==0||!Z(e[1]))&&e[1].length===32)return{type:"wsh",hash:e[1]}},decode:e=>e.type==="wsh"?[0,e.hash]:void 0},Pf={encode(e){if(!(e.length!==2||e[0]!==0||!Z(e[1]))&&e[1].length===20)return{type:"wpkh",hash:e[1]}},decode:e=>e.type==="wpkh"?[0,e.hash]:void 0},Nf={encode(e){const t=e.length-1;if(e[t]!=="CHECKMULTISIG")return;const n=e[0],r=e[t-1];if(typeof n!="number"||typeof r!="number")return;const o=e.slice(1,-2);if(r===o.length){for(const i of o)if(!Z(i))return;return{type:"ms",m:n,pubkeys:o}}},decode:e=>e.type==="ms"?[e.m,...e.pubkeys,e.pubkeys.length,"CHECKMULTISIG"]:void 0},qf={encode(e){if(!(e.length!==2||e[0]!==1||!Z(e[1])))return{type:"tr",pubkey:e[1]}},decode:e=>e.type==="tr"?[1,e.pubkey]:void 0},Wf={encode(e){const t=e.length-1;if(e[t]!=="CHECKSIG")return;const n=[];for(let r=0;r<t;r++){const o=e[r];if(r&1){if(o!=="CHECKSIGVERIFY"||r===t-1)return;continue}if(!Z(o))return;n.push(o)}return{type:"tr_ns",pubkeys:n}},decode:e=>{if(e.type!=="tr_ns")return;const t=[];for(let n=0;n<e.pubkeys.length-1;n++)t.push(e.pubkeys[n],"CHECKSIGVERIFY");return t.push(e.pubkeys[e.pubkeys.length-1],"CHECKSIG"),t}},zf={encode(e){const t=e.length-1;if(e[t]!=="NUMEQUAL"||e[1]!=="CHECKSIG")return;const n=[],r=Bf(e[t-1]);if(typeof r=="number"){for(let o=0;o<t-1;o++){const i=e[o];if(o&1){if(i!==(o===1?"CHECKSIG":"CHECKSIGADD"))throw new Error("OutScript.encode/tr_ms: wrong element");continue}if(!Z(i))throw new Error("OutScript.encode/tr_ms: wrong key element");n.push(i)}return{type:"tr_ms",pubkeys:n,m:r}}},decode:e=>{if(e.type!=="tr_ms")return;const t=[e.pubkeys[0],"CHECKSIG"];for(let n=1;n<e.pubkeys.length;n++)t.push(e.pubkeys[n],"CHECKSIGADD");return t.push(e.m,"NUMEQUAL"),t}},Kf={encode(e){return{type:"unknown",script:re.encode(e)}},decode:e=>e.type==="unknown"?re.decode(e.script):void 0},Vf=[Rf,Lf,Tf,Uf,Of,Pf,Nf,qf,Wf,zf,Kf],Mf=t0(re,ar.match(Vf)),he=ve(Mf,e=>{if(e.type==="pk"&&!h0(e.pubkey,Ee.ecdsa))throw new Error("OutScript/pk: wrong key");if((e.type==="pkh"||e.type==="sh"||e.type==="wpkh")&&(!Z(e.hash)||e.hash.length!==20))throw new Error(`OutScript/${e.type}: wrong hash`);if(e.type==="wsh"&&(!Z(e.hash)||e.hash.length!==32))throw new Error("OutScript/wsh: wrong hash");if(e.type==="tr"&&(!Z(e.pubkey)||!h0(e.pubkey,Ee.schnorr)))throw new Error("OutScript/tr: wrong taproot public key");if((e.type==="ms"||e.type==="tr_ns"||e.type==="tr_ms")&&!Array.isArray(e.pubkeys))throw new Error("OutScript/multisig: wrong pubkeys array");if(e.type==="ms"){const t=e.pubkeys.length;for(const n of e.pubkeys)if(!h0(n,Ee.ecdsa))throw new Error("OutScript/multisig: wrong pubkey");if(e.m<=0||t>16||e.m>t)throw new Error("OutScript/multisig: invalid params")}if(e.type==="tr_ns"||e.type==="tr_ms"){for(const t of e.pubkeys)if(!h0(t,Ee.schnorr))throw new Error(`OutScript/${e.type}: wrong pubkey`)}if(e.type==="tr_ms"){const t=e.pubkeys.length;if(e.m<=0||t>999||e.m>t)throw new Error("OutScript/tr_ms: invalid params")}return e});function Io(e,t){if(!ae(e.hash,ue(t)))throw new Error("checkScript: wsh wrong witnessScript hash");const n=he.decode(t);if(n.type==="tr"||n.type==="tr_ns"||n.type==="tr_ms")throw new Error(`checkScript: P2${n.type} cannot be wrapped in P2SH`);if(n.type==="wpkh"||n.type==="sh")throw new Error(`checkScript: P2${n.type} cannot be wrapped in P2WSH`)}function Zi(e,t,n){if(e){const r=he.decode(e);if(r.type==="tr_ns"||r.type==="tr_ms"||r.type==="ms"||r.type=="pk")throw new Error(`checkScript: non-wrapped ${r.type}`);if(r.type==="sh"&&t){if(!ae(r.hash,Jr(t)))throw new Error("checkScript: sh wrong redeemScript hash");const o=he.decode(t);if(o.type==="tr"||o.type==="tr_ns"||o.type==="tr_ms")throw new Error(`checkScript: P2${o.type} cannot be wrapped in P2SH`);if(o.type==="sh")throw new Error("checkScript: P2SH cannot be wrapped in P2SH")}r.type==="wsh"&&n&&Io(r,n)}if(t){const r=he.decode(t);r.type==="wsh"&&n&&Io(r,n)}}const fx=(e,t=O0)=>{if(!h0(e,Ee.ecdsa))throw new Error("P2WPKH: invalid publicKey");if(e.length===65)throw new Error("P2WPKH: uncompressed public key");const n=Jr(e);return{type:"wpkh",script:he.encode({type:"wpkh",hash:n}),address:Rr(t).encode({type:"wpkh",hash:n}),hash:n}},Gf=192,vr=(e,t=Gf)=>Wi("TapLeaf",new Uint8Array([t]),me.encode(e)),Xi=rc(ue);function Qi(e,t){if(t.length<2||t.length>40)throw new Error("Witness: invalid length");if(e>16)throw new Error("Witness: invalid version");if(e===0&&!(t.length===20||t.length===32))throw new Error("Witness: invalid length for version")}function yr(e,t,n=O0){Qi(e,t);const r=e===0?mr:Zo;return r.encode(n.bech32,[e].concat(r.toWords(t)))}function Ro(e,t){return Xi.encode(Ze(Uint8Array.from(t),e))}function Rr(e=O0){return{encode(t){const{type:n}=t;if(n==="wpkh")return yr(0,t.hash,e);if(n==="wsh")return yr(0,t.hash,e);if(n==="tr")return yr(1,t.pubkey,e);if(n==="pkh")return Ro(t.hash,[e.pubKeyHash]);if(n==="sh")return Ro(t.hash,[e.scriptHash]);throw new Error(`Unknown address type=${n}`)},decode(t){if(t.length<14||t.length>74)throw new Error("Invalid address length");if(e.bech32&&t.toLowerCase().startsWith(`${e.bech32}1`)){let r;try{if(r=mr.decode(t),r.words[0]!==0)throw new Error(`bech32: wrong version=${r.words[0]}`)}catch{if(r=Zo.decode(t),r.words[0]===0)throw new Error(`bech32m: wrong version=${r.words[0]}`)}if(r.prefix!==e.bech32)throw new Error(`wrong bech32 prefix=${r.prefix}`);const[o,...i]=r.words,s=mr.fromWords(i);if(Qi(o,s),o===0&&s.length===32)return{type:"wsh",hash:s};if(o===0&&s.length===20)return{type:"wpkh",hash:s};if(o===1&&s.length===32)return{type:"tr",pubkey:s};throw new Error("Unknown witness program")}const n=Xi.decode(t);if(n.length!==21)throw new Error("Invalid base58 address");if(n[0]===e.pubKeyHash)return{type:"pkh",hash:n.slice(1)};if(n[0]===e.scriptHash)return{type:"sh",hash:n.slice(1)};throw new Error(`Invalid address prefix=${n[0]}`)}}}const Q0=new Uint8Array(32),Yf={amount:0xffffffffffffffffn,script:ee},jf=e=>Math.ceil(e/4),Zf=8,Xf=2,Ye=0,Ji=4294967295;ar.decimal(Zf);const R0=(e,t)=>e===void 0?t:e;function Qt(e){if(Array.isArray(e))return e.map(t=>Qt(t));if(Z(e))return Uint8Array.from(e);if(["number","bigint","boolean","string","undefined"].includes(typeof e))return e;if(e===null)return e;if(typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Qt(n)]));throw new Error(`cloneDeep: unknown type=${e} (${typeof e})`)}const K={DEFAULT:0,ALL:1,NONE:2,SINGLE:3,ANYONECANPAY:128},Qf={DEFAULT:K.DEFAULT,ALL:K.ALL,NONE:K.NONE,SINGLE:K.SINGLE,DEFAULT_ANYONECANPAY:K.DEFAULT|K.ANYONECANPAY,ALL_ANYONECANPAY:K.ALL|K.ANYONECANPAY,NONE_ANYONECANPAY:K.NONE|K.ANYONECANPAY,SINGLE_ANYONECANPAY:K.SINGLE|K.ANYONECANPAY},Jf=Ki(Qf);function ex(e,t,n,r=ee){return ae(n,t)&&(e=vf(e,r),t=qi(e)),{privKey:e,pubKey:t}}function je(e){if(e.script===void 0||e.amount===void 0)throw new Error("Transaction/output: script and amount required");return{script:e.script,amount:e.amount}}function _0(e){if(e.txid===void 0||e.index===void 0)throw new Error("Transaction/input: txid and index required");return{txid:e.txid,index:e.index,sequence:R0(e.sequence,Ji),finalScriptSig:R0(e.finalScriptSig,ee)}}function br(e){for(const t in e){const n=t;_f.includes(n)||delete e[n]}}const Br=ce({txid:J(32,!0),index:Y});function tx(e){if(typeof e!="number"||typeof Jf[e]!="string")throw new Error(`Invalid SigHash=${e}`);return e}function Lo(e){const t=e&31;return{isAny:!!(e&K.ANYONECANPAY),isNone:t===K.NONE,isSingle:t===K.SINGLE}}function rx(e){if(e!==void 0&&{}.toString.call(e)!=="[object Object]")throw new Error(`Wrong object type for transaction options: ${e}`);const t={...e,version:R0(e.version,Xf),lockTime:R0(e.lockTime,0),PSBTVersion:R0(e.PSBTVersion,0)};if(typeof t.allowUnknowInput<"u"&&(e.allowUnknownInputs=t.allowUnknowInput),typeof t.allowUnknowOutput<"u"&&(e.allowUnknownOutputs=t.allowUnknowOutput),typeof t.lockTime!="number")throw new Error("Transaction lock time should be number");if(Y.encode(t.lockTime),t.PSBTVersion!==0&&t.PSBTVersion!==2)throw new Error(`Unknown PSBT version ${t.PSBTVersion}`);for(const n of["allowUnknownVersion","allowUnknownOutputs","allowUnknownInputs","disableScriptCheck","bip174jsCompat","allowLegacyWitnessUtxo","lowR"]){const r=t[n];if(r!==void 0&&typeof r!="boolean")throw new Error(`Transation options wrong type: ${n}=${r} (${typeof r})`)}if(t.allowUnknownVersion?typeof t.version=="number":![-1,0,1,2,3].includes(t.version))throw new Error(`Unknown version: ${t.version}`);if(t.customScripts!==void 0){const n=t.customScripts;if(!Array.isArray(n))throw new Error(`wrong custom scripts type (expected array): customScripts=${n} (${typeof n})`);for(const r of n){if(typeof r.encode!="function"||typeof r.decode!="function")throw new Error(`wrong script=${r} (${typeof r})`);if(r.finalizeTaproot!==void 0&&typeof r.finalizeTaproot!="function")throw new Error(`wrong script=${r} (${typeof r})`)}}return Object.freeze(t)}function To(e){if(e.nonWitnessUtxo&&e.index!==void 0){const t=e.nonWitnessUtxo.outputs.length-1;if(e.index>t)throw new Error(`validateInput: index(${e.index}) not in nonWitnessUtxo`);const n=e.nonWitnessUtxo.outputs[e.index];if(e.witnessUtxo&&(!ae(e.witnessUtxo.script,n.script)||e.witnessUtxo.amount!==n.amount))throw new Error("validateInput: witnessUtxo different from nonWitnessUtxo");if(e.txid){if(e.nonWitnessUtxo.outputs.length-1<e.index)throw new Error("nonWitnessUtxo: incorect output index");const o=L0.fromRaw(l0.encode(e.nonWitnessUtxo),{allowUnknownOutputs:!0,disableScriptCheck:!0,allowUnknownInputs:!0}),i=Q.encode(e.txid);if(o.isFinal&&o.id!==i)throw new Error(`nonWitnessUtxo: wrong txid, exp=${i} got=${o.id}`)}}return e}function Pt(e){if(e.nonWitnessUtxo){if(e.index===void 0)throw new Error("Unknown input index");return e.nonWitnessUtxo.outputs[e.index]}else{if(e.witnessUtxo)return e.witnessUtxo;throw new Error("Cannot find previous output info")}}function Uo(e,t,n,r=!1,o=!1){let{nonWitnessUtxo:i,txid:s}=e;typeof i=="string"&&(i=Q.decode(i)),Z(i)&&(i=l0.decode(i)),!("nonWitnessUtxo"in e)&&i===void 0&&(i=t?.nonWitnessUtxo),typeof s=="string"&&(s=Q.decode(s)),s===void 0&&(s=t?.txid);let a={...t,...e,nonWitnessUtxo:i,txid:s};!("nonWitnessUtxo"in e)&&a.nonWitnessUtxo===void 0&&delete a.nonWitnessUtxo,a.sequence===void 0&&(a.sequence=Ji),a.tapMerkleRoot===null&&delete a.tapMerkleRoot,a=Ir(xr,a,t,n,o),nn.encode(a);let f;return a.nonWitnessUtxo&&a.index!==void 0?f=a.nonWitnessUtxo.outputs[a.index]:a.witnessUtxo&&(f=a.witnessUtxo),f&&!r&&Zi(f&&f.script,a.redeemScript,a.witnessScript),a}function Oo(e,t=!1){let n="legacy",r=K.ALL;const o=Pt(e),i=he.decode(o.script);let s=i.type,a=i;const f=[i];if(i.type==="tr")return r=K.DEFAULT,{txType:"taproot",type:"tr",last:i,lastScript:o.script,defaultSighash:r,sighash:e.sighashType||r};{if((i.type==="wpkh"||i.type==="wsh")&&(n="segwit"),i.type==="sh"){if(!e.redeemScript)throw new Error("inputType: sh without redeemScript");let u=he.decode(e.redeemScript);(u.type==="wpkh"||u.type==="wsh")&&(n="segwit"),f.push(u),a=u,s+=`-${u.type}`}if(a.type==="wsh"){if(!e.witnessScript)throw new Error("inputType: wsh without witnessScript");let u=he.decode(e.witnessScript);u.type==="wsh"&&(n="segwit"),f.push(u),a=u,s+=`-${u.type}`}const c=f[f.length-1];if(c.type==="sh"||c.type==="wsh")throw new Error("inputType: sh/wsh cannot be terminal type");const x=he.encode(c),h={type:s,txType:n,last:c,lastScript:x,defaultSighash:r,sighash:e.sighashType||r};if(n==="legacy"&&!t&&!e.nonWitnessUtxo)throw new Error("Transaction/sign: legacy input without nonWitnessUtxo, can result in attack that forces paying higher fees. Pass allowLegacyWitnessUtxo=true, if you sure");return h}}class L0{global={};inputs=[];outputs=[];opts;constructor(t={}){const n=this.opts=rx(t);n.lockTime!==Ye&&(this.global.fallbackLocktime=n.lockTime),this.global.txVersion=n.version}static fromRaw(t,n={}){const r=l0.decode(t),o=new L0({...n,version:r.version,lockTime:r.lockTime});for(const i of r.outputs)o.addOutput(i);if(o.outputs=r.outputs,o.inputs=r.inputs,r.witnesses)for(let i=0;i<r.witnesses.length;i++)o.inputs[i].finalScriptWitness=r.witnesses[i];return o}static fromPSBT(t,n={}){let r;try{r=Ho.decode(t)}catch(h){try{r=$o.decode(t)}catch{throw h}}const o=r.global.version||0;if(o!==0&&o!==2)throw new Error(`Wrong PSBT version=${o}`);const i=r.global.unsignedTx,s=o===0?i?.version:r.global.txVersion,a=o===0?i?.lockTime:r.global.fallbackLocktime,f=new L0({...n,version:s,lockTime:a,PSBTVersion:o}),c=o===0?i?.inputs.length:r.global.inputCount;f.inputs=r.inputs.slice(0,c).map((h,u)=>To({finalScriptSig:ee,...r.global.unsignedTx?.inputs[u],...h}));const x=o===0?i?.outputs.length:r.global.outputCount;return f.outputs=r.outputs.slice(0,x).map((h,u)=>({...h,...r.global.unsignedTx?.outputs[u]})),f.global={...r.global,txVersion:s},a!==Ye&&(f.global.fallbackLocktime=a),f}toPSBT(t=this.opts.PSBTVersion){if(t!==0&&t!==2)throw new Error(`Wrong PSBT version=${t}`);const n=this.inputs.map(i=>To(ko(t,xr,i)));for(const i of n)i.partialSig&&!i.partialSig.length&&delete i.partialSig,i.finalScriptSig&&!i.finalScriptSig.length&&delete i.finalScriptSig,i.finalScriptWitness&&!i.finalScriptWitness.length&&delete i.finalScriptWitness;const r=this.outputs.map(i=>ko(t,Xt,i)),o={...this.global};return t===0?(o.unsignedTx=k0.decode(k0.encode({version:this.version,lockTime:this.lockTime,inputs:this.inputs.map(_0).map(i=>({...i,finalScriptSig:ee})),outputs:this.outputs.map(je)})),delete o.fallbackLocktime,delete o.txVersion):(o.version=t,o.txVersion=this.version,o.inputCount=this.inputs.length,o.outputCount=this.outputs.length,o.fallbackLocktime&&o.fallbackLocktime===Ye&&delete o.fallbackLocktime),this.opts.bip174jsCompat&&(n.length||n.push({}),r.length||r.push({})),(t===0?Ho:$o).encode({global:o,inputs:n,outputs:r})}get lockTime(){let t=Ye,n=0,r=Ye,o=0;for(const i of this.inputs)i.requiredHeightLocktime&&(t=Math.max(t,i.requiredHeightLocktime),n++),i.requiredTimeLocktime&&(r=Math.max(r,i.requiredTimeLocktime),o++);return n&&n>=o?t:r!==Ye?r:this.global.fallbackLocktime||Ye}get version(){if(this.global.txVersion===void 0)throw new Error("No global.txVersion");return this.global.txVersion}inputStatus(t){this.checkInputIdx(t);const n=this.inputs[t];return n.finalScriptSig&&n.finalScriptSig.length||n.finalScriptWitness&&n.finalScriptWitness.length?"finalized":n.tapKeySig||n.tapScriptSig&&n.tapScriptSig.length||n.partialSig&&n.partialSig.length?"signed":"unsigned"}inputSighash(t){this.checkInputIdx(t);const n=this.inputs[t].sighashType,r=n===void 0?K.DEFAULT:n,o=r===K.DEFAULT?K.ALL:r&3;return{sigInputs:r&K.ANYONECANPAY,sigOutputs:o}}signStatus(){let t=!0,n=!0,r=[],o=[];for(let i=0;i<this.inputs.length;i++){if(this.inputStatus(i)==="unsigned")continue;const{sigInputs:a,sigOutputs:f}=this.inputSighash(i);if(a===K.ANYONECANPAY?r.push(i):t=!1,f===K.ALL)n=!1;else if(f===K.SINGLE)o.push(i);else if(f!==K.NONE)throw new Error(`Wrong signature hash output type: ${f}`)}return{addInput:t,addOutput:n,inputs:r,outputs:o}}get isFinal(){for(let t=0;t<this.inputs.length;t++)if(this.inputStatus(t)!=="finalized")return!1;return!0}get hasWitnesses(){let t=!1;for(const n of this.inputs)n.finalScriptWitness&&n.finalScriptWitness.length&&(t=!0);return t}get weight(){if(!this.isFinal)throw new Error("Transaction is not finalized");let t=32;const n=this.outputs.map(je);t+=4*Fe.encode(this.outputs.length).length;for(const r of n)t+=32+4*me.encode(r.script).length;this.hasWitnesses&&(t+=2),t+=4*Fe.encode(this.inputs.length).length;for(const r of this.inputs)t+=160+4*me.encode(r.finalScriptSig||ee).length,this.hasWitnesses&&r.finalScriptWitness&&(t+=en.encode(r.finalScriptWitness).length);return t}get vsize(){return jf(this.weight)}toBytes(t=!1,n=!1){return l0.encode({version:this.version,lockTime:this.lockTime,inputs:this.inputs.map(_0).map(r=>({...r,finalScriptSig:t&&r.finalScriptSig||ee})),outputs:this.outputs.map(je),witnesses:this.inputs.map(r=>r.finalScriptWitness||[]),segwitFlag:n&&this.hasWitnesses})}get unsignedTx(){return this.toBytes(!1,!1)}get hex(){return Q.encode(this.toBytes(!0,this.hasWitnesses))}get hash(){return Q.encode(Ke(this.toBytes(!0)))}get id(){return Q.encode(Ke(this.toBytes(!0)).reverse())}checkInputIdx(t){if(!Number.isSafeInteger(t)||0>t||t>=this.inputs.length)throw new Error(`Wrong input index=${t}`)}getInput(t){return this.checkInputIdx(t),Qt(this.inputs[t])}get inputsLength(){return this.inputs.length}addInput(t,n=!1){if(!n&&!this.signStatus().addInput)throw new Error("Tx has signed inputs, cannot add new one");return this.inputs.push(Uo(t,void 0,void 0,this.opts.disableScriptCheck)),this.inputs.length-1}updateInput(t,n,r=!1){this.checkInputIdx(t);let o;if(!r){const i=this.signStatus();(!i.addInput||i.inputs.includes(t))&&(o=kf)}this.inputs[t]=Uo(n,this.inputs[t],o,this.opts.disableScriptCheck,this.opts.allowUnknown)}checkOutputIdx(t){if(!Number.isSafeInteger(t)||0>t||t>=this.outputs.length)throw new Error(`Wrong output index=${t}`)}getOutput(t){return this.checkOutputIdx(t),Qt(this.outputs[t])}getOutputAddress(t,n=O0){const r=this.getOutput(t);if(r.script)return Rr(n).encode(he.decode(r.script))}get outputsLength(){return this.outputs.length}normalizeOutput(t,n,r){let{amount:o,script:i}=t;if(o===void 0&&(o=n?.amount),typeof o!="bigint")throw new Error(`Wrong amount type, should be of type bigint in sats, but got ${o} of type ${typeof o}`);typeof i=="string"&&(i=Q.decode(i)),i===void 0&&(i=n?.script);let s={...n,...t,amount:o,script:i};if(s.amount===void 0&&delete s.amount,s=Ir(Xt,s,n,r,this.opts.allowUnknown),on.encode(s),s.script&&!this.opts.allowUnknownOutputs&&he.decode(s.script).type==="unknown")throw new Error("Transaction/output: unknown output script type, there is a chance that input is unspendable. Pass allowUnknownOutputs=true, if you sure");return this.opts.disableScriptCheck||Zi(s.script,s.redeemScript,s.witnessScript),s}addOutput(t,n=!1){if(!n&&!this.signStatus().addOutput)throw new Error("Tx has signed outputs, cannot add new one");return this.outputs.push(this.normalizeOutput(t)),this.outputs.length-1}updateOutput(t,n,r=!1){this.checkOutputIdx(t);let o;if(!r){const i=this.signStatus();(!i.addOutput||i.outputs.includes(t))&&(o=Hf)}this.outputs[t]=this.normalizeOutput(n,this.outputs[t],o)}addOutputAddress(t,n,r=O0){return this.addOutput({script:he.encode(Rr(r).decode(t)),amount:n})}get fee(){let t=0n;for(const r of this.inputs){const o=Pt(r);if(!o)throw new Error("Empty input amount");t+=o.amount}const n=this.outputs.map(je);for(const r of n)t-=r.amount;return t}preimageLegacy(t,n,r){const{isAny:o,isNone:i,isSingle:s}=Lo(r);if(t<0||!Number.isSafeInteger(t))throw new Error(`Invalid input idx=${t}`);if(s&&t>=this.outputs.length||t>=this.inputs.length)return cf.encode(1n);n=re.encode(re.decode(n).filter(x=>x!=="CODESEPARATOR"));let a=this.inputs.map(_0).map((x,h)=>({...x,finalScriptSig:h===t?n:ee}));o?a=[a[t]]:(i||s)&&(a=a.map((x,h)=>({...x,sequence:h===t?x.sequence:0})));let f=this.outputs.map(je);i?f=[]:s&&(f=f.slice(0,t).fill(Yf).concat([f[t]]));const c=l0.encode({lockTime:this.lockTime,version:this.version,segwitFlag:!1,inputs:a,outputs:f});return Ke(c,u0.encode(r))}preimageWitnessV0(t,n,r,o){const{isAny:i,isNone:s,isSingle:a}=Lo(r);let f=Q0,c=Q0,x=Q0;const h=this.inputs.map(_0),u=this.outputs.map(je);i||(f=Ke(...h.map(Br.encode))),!i&&!a&&!s&&(c=Ke(...h.map(l=>Y.encode(l.sequence)))),!a&&!s?x=Ke(...u.map(Je.encode)):a&&t<u.length&&(x=Ke(Je.encode(u[t])));const d=h[t];return Ke(u0.encode(this.version),f,c,J(32,!0).encode(d.txid),Y.encode(d.index),me.encode(n),Ot.encode(o),Y.encode(d.sequence),x,Y.encode(this.lockTime),Y.encode(r))}preimageWitnessV1(t,n,r,o,i=-1,s,a=192,f){if(!Array.isArray(o)||this.inputs.length!==o.length)throw new Error(`Invalid amounts array=${o}`);if(!Array.isArray(n)||this.inputs.length!==n.length)throw new Error(`Invalid prevOutScript array=${n}`);const c=[Me.encode(0),Me.encode(r),u0.encode(this.version),Y.encode(this.lockTime)],x=r===K.DEFAULT?K.ALL:r&3,h=r&K.ANYONECANPAY,u=this.inputs.map(_0),d=this.outputs.map(je);h!==K.ANYONECANPAY&&c.push(...[u.map(Br.encode),o.map(Ot.encode),n.map(me.encode),u.map(E=>Y.encode(E.sequence))].map(E=>ue(Ze(...E)))),x===K.ALL&&c.push(ue(Ze(...d.map(Je.encode))));const l=(f?1:0)|(s?2:0);if(c.push(new Uint8Array([l])),h===K.ANYONECANPAY){const E=u[t];c.push(Br.encode(E),Ot.encode(o[t]),me.encode(n[t]),Y.encode(E.sequence))}else c.push(Y.encode(t));return l&1&&c.push(ue(me.encode(f||ee))),x===K.SINGLE&&c.push(t<d.length?ue(Je.encode(d[t])):Q0),s&&c.push(vr(s,a),Me.encode(0),u0.encode(i)),Wi("TapSighash",...c)}signIdx(t,n,r,o){this.checkInputIdx(n);const i=this.inputs[n],s=Oo(i,this.opts.allowLegacyWitnessUtxo);if(!Z(t)){if(!i.bip32Derivation||!i.bip32Derivation.length)throw new Error("bip32Derivation: empty");const x=i.bip32Derivation.filter(u=>u[1].fingerprint==t.fingerprint).map(([u,{path:d}])=>{let l=t;for(const E of d)l=l.deriveChild(E);if(!ae(l.publicKey,u))throw new Error("bip32Derivation: wrong pubKey");if(!l.privateKey)throw new Error("bip32Derivation: no privateKey");return l});if(!x.length)throw new Error(`bip32Derivation: no items with fingerprint=${t.fingerprint}`);let h=!1;for(const u of x)this.signIdx(u.privateKey,n)&&(h=!0);return h}r?r.forEach(tx):r=[s.defaultSighash];const a=s.sighash;if(!r.includes(a))throw new Error(`Input with not allowed sigHash=${a}. Allowed: ${r.join(", ")}`);const{sigOutputs:f}=this.inputSighash(n);if(f===K.SINGLE&&n>=this.outputs.length)throw new Error(`Input with sighash SINGLE, but there is no output with corresponding index=${n}`);const c=Pt(i);if(s.txType==="taproot"){const x=this.inputs.map(Pt),h=x.map(p=>p.script),u=x.map(p=>p.amount);let d=!1,l=qi(t),E=i.tapMerkleRoot||ee;if(i.tapInternalKey){const{pubKey:p,privKey:y}=ex(t,l,i.tapInternalKey,E),[w,g]=yf(i.tapInternalKey,E);if(ae(w,p)){const v=this.preimageWitnessV1(n,h,a,u),b=Ze(Co(v,y,o),a!==K.DEFAULT?new Uint8Array([a]):ee);this.updateInput(n,{tapKeySig:b},!0),d=!0}}if(i.tapLeafScript){i.tapScriptSig=i.tapScriptSig||[];for(const[p,y]of i.tapLeafScript){const w=y.subarray(0,-1),g=re.decode(w),v=y[y.length-1],b=vr(w,v);if(g.findIndex(I=>Z(I)&&ae(I,l))===-1)continue;const F=this.preimageWitnessV1(n,h,a,u,void 0,w,v),_=Ze(Co(F,t,o),a!==K.DEFAULT?new Uint8Array([a]):ee);this.updateInput(n,{tapScriptSig:[[{pubKey:l,leafHash:b},_]]},!0),d=!0}}if(!d)throw new Error("No taproot scripts signed");return!0}else{const x=wf(t);let h=!1;const u=Jr(x);for(const E of re.decode(s.lastScript))Z(E)&&(ae(E,x)||ae(E,u))&&(h=!0);if(!h)throw new Error(`Input script doesn't have pubKey: ${s.lastScript}`);let d;if(s.txType==="legacy")d=this.preimageLegacy(n,s.lastScript,a);else if(s.txType==="segwit"){let E=s.lastScript;s.last.type==="wpkh"&&(E=he.encode({type:"pkh",hash:s.last.hash})),d=this.preimageWitnessV0(n,E,a,c.amount)}else throw new Error(`Transaction/sign: unknown tx type: ${s.txType}`);const l=Ef(d,t,this.opts.lowR);this.updateInput(n,{partialSig:[[x,Ze(l,new Uint8Array([a]))]]},!0)}return!0}sign(t,n,r){let o=0;for(let i=0;i<this.inputs.length;i++)try{this.signIdx(t,i,n,r)&&o++}catch{}if(!o)throw new Error("No inputs signed");return o}finalizeIdx(t){if(this.checkInputIdx(t),this.fee<0n)throw new Error("Outputs spends more than inputs amount");const n=this.inputs[t],r=Oo(n,this.opts.allowLegacyWitnessUtxo);if(r.txType==="taproot"){if(n.tapKeySig)n.finalScriptWitness=[n.tapKeySig];else if(n.tapLeafScript&&n.tapScriptSig){const f=n.tapLeafScript.sort((c,x)=>H0.encode(c[0]).length-H0.encode(x[0]).length);for(const[c,x]of f){const h=x.slice(0,-1),u=x[x.length-1],d=he.decode(h),l=vr(h,u),E=n.tapScriptSig.filter(y=>ae(y[0].leafHash,l));let p=[];if(d.type==="tr_ms"){const y=d.m,w=d.pubkeys;let g=0;for(const v of w){const b=E.findIndex(C=>ae(C[0].pubKey,v));if(g===y||b===-1){p.push(ee);continue}p.push(E[b][1]),g++}if(g!==y)continue}else if(d.type==="tr_ns"){for(const y of d.pubkeys){const w=E.findIndex(g=>ae(g[0].pubKey,y));w!==-1&&p.push(E[w][1])}if(p.length!==d.pubkeys.length)continue}else if(d.type==="unknown"&&this.opts.allowUnknownInputs){const y=re.decode(h);if(p=E.map(([{pubKey:w},g])=>{const v=y.findIndex(b=>Z(b)&&ae(b,w));if(v===-1)throw new Error("finalize/taproot: cannot find position of pubkey in script");return{signature:g,pos:v}}).sort((w,g)=>w.pos-g.pos).map(w=>w.signature),!p.length)continue}else{const y=this.opts.customScripts;if(y)for(const w of y){if(!w.finalizeTaproot)continue;const g=re.decode(h),v=w.encode(g);if(v===void 0)continue;const b=w.finalizeTaproot(h,v,E);if(b){n.finalScriptWitness=b.concat(H0.encode(c)),n.finalScriptSig=ee,br(n);return}}throw new Error("Finalize: Unknown tapLeafScript")}n.finalScriptWitness=p.reverse().concat([h,H0.encode(c)]);break}if(!n.finalScriptWitness)throw new Error("finalize/taproot: empty witness")}else throw new Error("finalize/taproot: unknown input");n.finalScriptSig=ee,br(n);return}if(!n.partialSig||!n.partialSig.length)throw new Error("Not enough partial sign");let o=ee,i=[];if(r.last.type==="ms"){const f=r.last.m,c=r.last.pubkeys;let x=[];for(const h of c){const u=n.partialSig.find(d=>ae(h,d[0]));u&&x.push(u[1])}if(x=x.slice(0,f),x.length!==f)throw new Error(`Multisig: wrong signatures count, m=${f} n=${c.length} signatures=${x.length}`);o=re.encode([0,...x])}else if(r.last.type==="pk")o=re.encode([n.partialSig[0][1]]);else if(r.last.type==="pkh")o=re.encode([n.partialSig[0][1],n.partialSig[0][0]]);else if(r.last.type==="wpkh")o=ee,i=[n.partialSig[0][1],n.partialSig[0][0]];else if(r.last.type==="unknown"&&!this.opts.allowUnknownInputs)throw new Error("Unknown inputs not allowed");let s,a;if(r.type.includes("wsh-")&&(o.length&&r.lastScript.length&&(i=re.decode(o).map(f=>{if(f===0)return ee;if(Z(f))return f;throw new Error(`Wrong witness op=${f}`)})),i=i.concat(r.lastScript)),r.txType==="segwit"&&(a=i),r.type.startsWith("sh-wsh-")?s=re.encode([re.encode([0,ue(r.lastScript)])]):r.type.startsWith("sh-")?s=re.encode([...re.decode(o),r.lastScript]):r.type.startsWith("wsh-")||r.txType!=="segwit"&&(s=o),!s&&!a)throw new Error("Unknown error finalizing input");s&&(n.finalScriptSig=s),a&&(n.finalScriptWitness=a),br(n)}finalize(){for(let t=0;t<this.inputs.length;t++)this.finalizeIdx(t)}extract(){if(!this.isFinal)throw new Error("Transaction has unfinalized inputs");if(!this.outputs.length)throw new Error("Transaction has no outputs");if(this.fee<0n)throw new Error("Outputs spends more than inputs amount");return this.toBytes(!0,!0)}combine(t){for(const o of["PSBTVersion","version","lockTime"])if(this.opts[o]!==t.opts[o])throw new Error(`Transaction/combine: different ${o} this=${this.opts[o]} other=${t.opts[o]}`);for(const o of["inputs","outputs"])if(this[o].length!==t[o].length)throw new Error(`Transaction/combine: different ${o} length this=${this[o].length} other=${t[o].length}`);const n=this.global.unsignedTx?k0.encode(this.global.unsignedTx):ee,r=t.global.unsignedTx?k0.encode(t.global.unsignedTx):ee;if(!ae(n,r))throw new Error("Transaction/combine: different unsigned tx");this.global=Ir(tn,this.global,t.global,void 0,this.opts.allowUnknown);for(let o=0;o<this.inputs.length;o++)this.updateInput(o,t.inputs[o],!0);for(let o=0;o<this.outputs.length;o++)this.updateOutput(o,t.outputs[o],!0);return this}clone(){return L0.fromPSBT(this.toPSBT(this.opts.PSBTVersion),this.opts)}}export{O0 as N,cx as T,L0 as a,ax as m,fx as p,ox as r};
